<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>luxpy.toolboxes.rgb2spec.smits_mitsuba &mdash; LuxPy 1.11.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=6cf1fb80"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            LuxPy
          </a>
              <div class="version">
                1.11.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License: GPLv3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../required_packages.html">Imported (required) packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../luxpy_structure.html">Luxpy package structure</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">LuxPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../rgb2spec.html">luxpy.toolboxes.rgb2spec</a></li>
      <li class="breadcrumb-item active">luxpy.toolboxes.rgb2spec.smits_mitsuba</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for luxpy.toolboxes.rgb2spec.smits_mitsuba</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">########################################################################</span>
<span class="c1"># &lt;LUXPY: a Python package for lighting and color science.&gt;</span>
<span class="c1"># Copyright (C) &lt;2017&gt;  &lt;Kevin A.G. Smet&gt; (ksmet1977 at gmail.com)</span>
<span class="c1">#</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation, either version 3 of the License.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="c1">#########################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for Smits-style RGB to Spectrum conversion</span>

<span class="sd"> :_BASESPEC_SMITS: Default dict with base spectra for white, cyan, magenta, yellow, blue, green and red for each intent (&#39;rfl&#39; or &#39;spd&#39;)</span>
<span class="sd"> </span>
<span class="sd"> :rgb_to_spec_smits(): Convert an array of RGB values to a spectrum using a Smits like method as implemented in Mitsuba.</span>
<span class="sd"> </span>
<span class="sd"> based on https://github.com/mitsuba-renderer/mitsuba/blob/1fd0f671dfcb77f813c0d6a36f2aa4e480b5ca8e/src/libcore/spectrum.cpp</span>
<span class="sd">.. codeauthor:: Kevin A.G. Smet (ksmet1977 at gmail.com)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 

<span class="kn">from</span> <span class="nn">luxpy</span> <span class="kn">import</span> <span class="n">cie_interp</span><span class="p">,</span> <span class="n">getwlr</span><span class="p">,</span> <span class="n">_WL3</span><span class="p">,</span> <span class="n">xyz_to_srgb</span><span class="p">,</span> <span class="n">srgb_to_xyz</span>



<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rgb2spec_entries&#39;</span><span class="p">,</span> <span class="s1">&#39;rgb_to_spec_smits&#39;</span><span class="p">]</span>

<span class="c1">#==========================================================================</span>
<span class="c1"># Smits-style RGB to Spectrum conversion data generated by Karl vom Berge</span>
<span class="c1"># as implemented in Mitsuba 1.</span>
<span class="c1">#==========================================================================</span>

<span class="n">RGB2Spec_wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">380.000000</span><span class="p">,</span> <span class="mf">390.967743</span><span class="p">,</span> <span class="mf">401.935486</span><span class="p">,</span> <span class="mf">412.903229</span><span class="p">,</span> <span class="mf">423.870972</span><span class="p">,</span> <span class="mf">434.838715</span><span class="p">,</span>
                                <span class="mf">445.806458</span><span class="p">,</span> <span class="mf">456.774200</span><span class="p">,</span> <span class="mf">467.741943</span><span class="p">,</span> <span class="mf">478.709686</span><span class="p">,</span> <span class="mf">489.677429</span><span class="p">,</span> <span class="mf">500.645172</span><span class="p">,</span>
                                <span class="mf">511.612915</span><span class="p">,</span> <span class="mf">522.580627</span><span class="p">,</span> <span class="mf">533.548340</span><span class="p">,</span> <span class="mf">544.516052</span><span class="p">,</span> <span class="mf">555.483765</span><span class="p">,</span> <span class="mf">566.451477</span><span class="p">,</span>
                                <span class="mf">577.419189</span><span class="p">,</span> <span class="mf">588.386902</span><span class="p">,</span> <span class="mf">599.354614</span><span class="p">,</span> <span class="mf">610.322327</span><span class="p">,</span> <span class="mf">621.290039</span><span class="p">,</span> <span class="mf">632.257751</span><span class="p">,</span>
                                <span class="mf">643.225464</span><span class="p">,</span> <span class="mf">654.193176</span><span class="p">,</span> <span class="mf">665.160889</span><span class="p">,</span> <span class="mf">676.128601</span><span class="p">,</span> <span class="mf">687.096313</span><span class="p">,</span> <span class="mf">698.064026</span><span class="p">,</span>
                                <span class="mf">709.031738</span><span class="p">,</span> <span class="mf">720.000000</span><span class="p">])</span>

<span class="n">RGBRefl2SpecWhite_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0618958571272863e+00</span><span class="p">,</span>   <span class="mf">1.0615019980348779e+00</span><span class="p">,</span>
                                    <span class="mf">1.0614335379927147e+00</span><span class="p">,</span>   <span class="mf">1.0622711654692485e+00</span><span class="p">,</span>
                                    <span class="mf">1.0622036218416742e+00</span><span class="p">,</span>   <span class="mf">1.0625059965187085e+00</span><span class="p">,</span>
                                    <span class="mf">1.0623938486985884e+00</span><span class="p">,</span>   <span class="mf">1.0624706448043137e+00</span><span class="p">,</span>
                                    <span class="mf">1.0625048144827762e+00</span><span class="p">,</span>   <span class="mf">1.0624366131308856e+00</span><span class="p">,</span>
                                    <span class="mf">1.0620694238892607e+00</span><span class="p">,</span>   <span class="mf">1.0613167586932164e+00</span><span class="p">,</span>
                                    <span class="mf">1.0610334029377020e+00</span><span class="p">,</span>   <span class="mf">1.0613868564828413e+00</span><span class="p">,</span>
                                    <span class="mf">1.0614215366116762e+00</span><span class="p">,</span>   <span class="mf">1.0620336151299086e+00</span><span class="p">,</span>
                                    <span class="mf">1.0625497454805051e+00</span><span class="p">,</span>   <span class="mf">1.0624317487992085e+00</span><span class="p">,</span>
                                    <span class="mf">1.0625249140554480e+00</span><span class="p">,</span>   <span class="mf">1.0624277664486914e+00</span><span class="p">,</span>
                                    <span class="mf">1.0624749854090769e+00</span><span class="p">,</span>   <span class="mf">1.0625538581025402e+00</span><span class="p">,</span>
                                    <span class="mf">1.0625326910104864e+00</span><span class="p">,</span>   <span class="mf">1.0623922312225325e+00</span><span class="p">,</span>
                                    <span class="mf">1.0623650980354129e+00</span><span class="p">,</span>   <span class="mf">1.0625256476715284e+00</span><span class="p">,</span>
                                    <span class="mf">1.0612277619533155e+00</span><span class="p">,</span>   <span class="mf">1.0594262608698046e+00</span><span class="p">,</span>
                                    <span class="mf">1.0599810758292072e+00</span><span class="p">,</span>   <span class="mf">1.0602547314449409e+00</span><span class="p">,</span>
                                    <span class="mf">1.0601263046243634e+00</span><span class="p">,</span>   <span class="mf">1.0606565756823634e+00</span><span class="p">])</span>

<span class="n">RGBRefl2SpecCyan_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0414628021426751e+00</span><span class="p">,</span>   <span class="mf">1.0328661533771188e+00</span><span class="p">,</span>
                                    <span class="mf">1.0126146228964314e+00</span><span class="p">,</span>   <span class="mf">1.0350460524836209e+00</span><span class="p">,</span>
                                    <span class="mf">1.0078661447098567e+00</span><span class="p">,</span>   <span class="mf">1.0422280385081280e+00</span><span class="p">,</span>
                                    <span class="mf">1.0442596738499825e+00</span><span class="p">,</span>   <span class="mf">1.0535238290294409e+00</span><span class="p">,</span>
                                    <span class="mf">1.0180776226938120e+00</span><span class="p">,</span>   <span class="mf">1.0442729908727713e+00</span><span class="p">,</span>
                                    <span class="mf">1.0529362541920750e+00</span><span class="p">,</span>   <span class="mf">1.0537034271160244e+00</span><span class="p">,</span>
                                    <span class="mf">1.0533901869215969e+00</span><span class="p">,</span>   <span class="mf">1.0537782700979574e+00</span><span class="p">,</span>
                                    <span class="mf">1.0527093770467102e+00</span><span class="p">,</span>   <span class="mf">1.0530449040446797e+00</span><span class="p">,</span>
                                    <span class="mf">1.0550554640191208e+00</span><span class="p">,</span>   <span class="mf">1.0553673610724821e+00</span><span class="p">,</span>
                                    <span class="mf">1.0454306634683976e+00</span><span class="p">,</span>   <span class="mf">6.2348950639230805e-01</span><span class="p">,</span>
                                    <span class="mf">1.8038071613188977e-01</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.6303759201984539e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.5217847035781367e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.5102257347258311e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">2.1708639328491472e-03</span><span class="p">,</span>   <span class="mf">6.5919466602369636e-04</span><span class="p">,</span>
                                    <span class="mf">1.2278815318539780e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.4669775637208031e-03</span><span class="p">,</span>
                                    <span class="mf">1.7119799082865147e-02</span><span class="p">,</span>   <span class="mf">4.9211089759759801e-03</span><span class="p">,</span>
                                    <span class="mf">5.8762925143334985e-03</span><span class="p">,</span>   <span class="mf">2.5259399415550079e-02</span><span class="p">])</span>

<span class="n">RGBRefl2SpecMagenta_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.9422138151236850e-01</span><span class="p">,</span>   <span class="mf">9.8986937122975682e-01</span><span class="p">,</span>
                                    <span class="mf">9.8293658286116958e-01</span><span class="p">,</span>   <span class="mf">9.9627868399859310e-01</span><span class="p">,</span>
                                    <span class="mf">1.0198955019000133e+00</span><span class="p">,</span>   <span class="mf">1.0166395501210359e+00</span><span class="p">,</span>
                                    <span class="mf">1.0220913178757398e+00</span><span class="p">,</span>   <span class="mf">9.9651666040682441e-01</span><span class="p">,</span>
                                    <span class="mf">1.0097766178917882e+00</span><span class="p">,</span>   <span class="mf">1.0215422470827016e+00</span><span class="p">,</span>
                                    <span class="mf">6.4031953387790963e-01</span><span class="p">,</span>   <span class="mf">2.5012379477078184e-03</span><span class="p">,</span>
                                    <span class="mf">6.5339939555769944e-03</span><span class="p">,</span>   <span class="mf">2.8334080462675826e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.1209675389074505e-11</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.0592291646646381e-03</span><span class="p">,</span>
                                    <span class="mf">3.3936718323331200e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.0638741121828406e-03</span><span class="p">,</span>
                                    <span class="mf">2.2203936168286292e-01</span><span class="p">,</span>   <span class="mf">6.3141140024811970e-01</span><span class="p">,</span>
                                    <span class="mf">9.7480985576500956e-01</span><span class="p">,</span>   <span class="mf">9.7209562333590571e-01</span><span class="p">,</span>
                                    <span class="mf">1.0173770302868150e+00</span><span class="p">,</span>   <span class="mf">9.9875194322734129e-01</span><span class="p">,</span>
                                    <span class="mf">9.4701725739602238e-01</span><span class="p">,</span>   <span class="mf">8.5258623154354796e-01</span><span class="p">,</span>
                                    <span class="mf">9.4897798581660842e-01</span><span class="p">,</span>   <span class="mf">9.4751876096521492e-01</span><span class="p">,</span>
                                    <span class="mf">9.9598944191059791e-01</span><span class="p">,</span>   <span class="mf">8.6301351503809076e-01</span><span class="p">,</span>
                                    <span class="mf">8.9150987853523145e-01</span><span class="p">,</span>   <span class="mf">8.4866492652845082e-01</span><span class="p">])</span>

<span class="n">RGBRefl2SpecYellow_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.5740622924920873e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.7982831631446787e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.2536564298613798e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.4571480044499710e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.9693514658007013e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.1836716037686721e-03</span><span class="p">,</span>
                                    <span class="mf">1.6781120601055327e-02</span><span class="p">,</span>   <span class="mf">9.6096355429062641e-02</span><span class="p">,</span>
                                    <span class="mf">2.1217357081986446e-01</span><span class="p">,</span>   <span class="mf">3.6169133290685068e-01</span><span class="p">,</span>
                                    <span class="mf">5.3961011543232529e-01</span><span class="p">,</span>   <span class="mf">7.4408810492171507e-01</span><span class="p">,</span>
                                    <span class="mf">9.2209571148394054e-01</span><span class="p">,</span>   <span class="mf">1.0460304298411225e+00</span><span class="p">,</span>
                                    <span class="mf">1.0513824989063714e+00</span><span class="p">,</span>   <span class="mf">1.0511991822135085e+00</span><span class="p">,</span>
                                    <span class="mf">1.0510530911991052e+00</span><span class="p">,</span>   <span class="mf">1.0517397230360510e+00</span><span class="p">,</span>
                                    <span class="mf">1.0516043086790485e+00</span><span class="p">,</span>   <span class="mf">1.0511944032061460e+00</span><span class="p">,</span>
                                    <span class="mf">1.0511590325868068e+00</span><span class="p">,</span>   <span class="mf">1.0516612465483031e+00</span><span class="p">,</span>
                                    <span class="mf">1.0514038526836869e+00</span><span class="p">,</span>   <span class="mf">1.0515941029228475e+00</span><span class="p">,</span>
                                    <span class="mf">1.0511460436960840e+00</span><span class="p">,</span>   <span class="mf">1.0515123758830476e+00</span><span class="p">,</span>
                                    <span class="mf">1.0508871369510702e+00</span><span class="p">,</span>   <span class="mf">1.0508923708102380e+00</span><span class="p">,</span>
                                    <span class="mf">1.0477492815668303e+00</span><span class="p">,</span>   <span class="mf">1.0493272144017338e+00</span><span class="p">,</span>
                                    <span class="mf">1.0435963333422726e+00</span><span class="p">,</span>   <span class="mf">1.0392280772051465e+00</span><span class="p">])</span>

<span class="n">RGBRefl2SpecRed_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.6575604867086180e-01</span><span class="p">,</span>   <span class="mf">1.1846442802747797e-01</span><span class="p">,</span>
                                    <span class="mf">1.2408293329637447e-01</span><span class="p">,</span>   <span class="mf">1.1371272058349924e-01</span><span class="p">,</span>
                                    <span class="mf">7.8992434518899132e-02</span><span class="p">,</span>   <span class="mf">3.2205603593106549e-02</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.0798365407877875e-02</span><span class="p">,</span>   <span class="mf">1.8051975516730392e-02</span><span class="p">,</span>
                                    <span class="mf">5.3407196598730527e-03</span><span class="p">,</span>   <span class="mf">1.3654918729501336e-02</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.9564213545642841e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.8444365067353252e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.0571884361529504e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.9375521078000011e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.0790476271835936e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.0224306697503633e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">2.2669167702495940e-03</span><span class="p">,</span>   <span class="mf">7.0200240494706634e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">8.1528469000299308e-03</span><span class="p">,</span>   <span class="mf">6.0772866969252792e-01</span><span class="p">,</span>
                                    <span class="mf">9.8831560865432400e-01</span><span class="p">,</span>   <span class="mf">9.9391691044078823e-01</span><span class="p">,</span>
                                    <span class="mf">1.0039338994753197e+00</span><span class="p">,</span>   <span class="mf">9.9234499861167125e-01</span><span class="p">,</span>
                                    <span class="mf">9.9926530858855522e-01</span><span class="p">,</span>   <span class="mf">1.0084621557617270e+00</span><span class="p">,</span>
                                    <span class="mf">9.8358296827441216e-01</span><span class="p">,</span>   <span class="mf">1.0085023660099048e+00</span><span class="p">,</span>
                                    <span class="mf">9.7451138326568698e-01</span><span class="p">,</span>   <span class="mf">9.8543269570059944e-01</span><span class="p">,</span>
                                    <span class="mf">9.3495763980962043e-01</span><span class="p">,</span>   <span class="mf">9.8713907792319400e-01</span><span class="p">])</span>

<span class="n">RGBRefl2SpecGreen_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.6494153587602255e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.0175013429732242e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.2547236272489583e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.4554964308388671e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.2526086181600525e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.9170697760437767e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">7.9955735204175690e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.3559433444469070e-03</span><span class="p">,</span>
                                    <span class="mf">6.5468611982999303e-02</span><span class="p">,</span>   <span class="mf">3.9572875517634137e-01</span><span class="p">,</span>
                                    <span class="mf">7.5244022299886659e-01</span><span class="p">,</span>   <span class="mf">9.6376478690218559e-01</span><span class="p">,</span>
                                    <span class="mf">9.9854433855162328e-01</span><span class="p">,</span>   <span class="mf">9.9992977025287921e-01</span><span class="p">,</span>
                                    <span class="mf">9.9939086751140449e-01</span><span class="p">,</span>   <span class="mf">9.9994372267071396e-01</span><span class="p">,</span>
                                    <span class="mf">9.9939121813418674e-01</span><span class="p">,</span>   <span class="mf">9.9911237310424483e-01</span><span class="p">,</span>
                                    <span class="mf">9.6019584878271580e-01</span><span class="p">,</span>   <span class="mf">6.3186279338432438e-01</span><span class="p">,</span>
                                    <span class="mf">2.5797401028763473e-01</span><span class="p">,</span>   <span class="mf">9.4014888527335638e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">3.0798345608649747e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.5230367033685034e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">6.8933410388274038e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.0352195539015398e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">8.5913667165340209e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.3690869120289398e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">7.8685832338754313e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">8.3657578711085132e-06</span><span class="p">,</span>
                                    <span class="mf">5.4301225442817177e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.7745589759259194e-03</span><span class="p">])</span>

<span class="n">RGBRefl2SpecBlue_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9.9209771469720676e-01</span><span class="p">,</span>   <span class="mf">9.8876426059369127e-01</span><span class="p">,</span>
                                    <span class="mf">9.9539040744505636e-01</span><span class="p">,</span>   <span class="mf">9.9529317353008218e-01</span><span class="p">,</span>
                                    <span class="mf">9.9181447411633950e-01</span><span class="p">,</span>   <span class="mf">1.0002584039673432e+00</span><span class="p">,</span>
                                    <span class="mf">9.9968478437342512e-01</span><span class="p">,</span>   <span class="mf">9.9988120766657174e-01</span><span class="p">,</span>
                                    <span class="mf">9.8504012146370434e-01</span><span class="p">,</span>   <span class="mf">7.9029849053031276e-01</span><span class="p">,</span>
                                    <span class="mf">5.6082198617463974e-01</span><span class="p">,</span>   <span class="mf">3.3133458513996528e-01</span><span class="p">,</span>
                                    <span class="mf">1.3692410840839175e-01</span><span class="p">,</span>   <span class="mf">1.8914906559664151e-02</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.1129770932550889e-06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.2395493167891873e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">4.1934593101534273e-04</span><span class="p">,</span>   <span class="mf">1.7473028136486615e-03</span><span class="p">,</span>
                                    <span class="mf">3.7999160177631316e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.5101474906588642e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">4.3716662898480967e-05</span><span class="p">,</span>   <span class="mf">7.5874501748732798e-03</span><span class="p">,</span>
                                    <span class="mf">2.5795650780554021e-02</span><span class="p">,</span>   <span class="mf">3.8168376532500548e-02</span><span class="p">,</span>
                                    <span class="mf">4.9489586408030833e-02</span><span class="p">,</span>   <span class="mf">4.9595992290102905e-02</span><span class="p">,</span>
                                    <span class="mf">4.9814819505812249e-02</span><span class="p">,</span>   <span class="mf">3.9840911064978023e-02</span><span class="p">,</span>
                                    <span class="mf">3.0501024937233868e-02</span><span class="p">,</span>   <span class="mf">2.1243054765241080e-02</span><span class="p">,</span>
                                    <span class="mf">6.9596532104356399e-03</span><span class="p">,</span>   <span class="mf">4.1733649330980525e-03</span><span class="p">])</span>

<span class="n">RGBIllum2SpecWhite_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1565232050369776e+00</span><span class="p">,</span>   <span class="mf">1.1567225000119139e+00</span><span class="p">,</span>
                                    <span class="mf">1.1566203150243823e+00</span><span class="p">,</span>   <span class="mf">1.1555782088080084e+00</span><span class="p">,</span>
                                    <span class="mf">1.1562175509215700e+00</span><span class="p">,</span>   <span class="mf">1.1567674012207332e+00</span><span class="p">,</span>
                                    <span class="mf">1.1568023194808630e+00</span><span class="p">,</span>   <span class="mf">1.1567677445485520e+00</span><span class="p">,</span>
                                    <span class="mf">1.1563563182952830e+00</span><span class="p">,</span>   <span class="mf">1.1567054702510189e+00</span><span class="p">,</span>
                                    <span class="mf">1.1565134139372772e+00</span><span class="p">,</span>   <span class="mf">1.1564336176499312e+00</span><span class="p">,</span>
                                    <span class="mf">1.1568023181530034e+00</span><span class="p">,</span>   <span class="mf">1.1473147688514642e+00</span><span class="p">,</span>
                                    <span class="mf">1.1339317140561065e+00</span><span class="p">,</span>   <span class="mf">1.1293876490671435e+00</span><span class="p">,</span>
                                    <span class="mf">1.1290515328639648e+00</span><span class="p">,</span>   <span class="mf">1.0504864823782283e+00</span><span class="p">,</span>
                                    <span class="mf">1.0459696042230884e+00</span><span class="p">,</span>   <span class="mf">9.9366687168595691e-01</span><span class="p">,</span>
                                    <span class="mf">9.5601669265393940e-01</span><span class="p">,</span>   <span class="mf">9.2467482033511805e-01</span><span class="p">,</span>
                                    <span class="mf">9.1499944702051761e-01</span><span class="p">,</span>   <span class="mf">8.9939467658453465e-01</span><span class="p">,</span>
                                    <span class="mf">8.9542520751331112e-01</span><span class="p">,</span>   <span class="mf">8.8870566693814745e-01</span><span class="p">,</span>
                                    <span class="mf">8.8222843814228114e-01</span><span class="p">,</span>   <span class="mf">8.7998311373826676e-01</span><span class="p">,</span>
                                    <span class="mf">8.7635244612244578e-01</span><span class="p">,</span>   <span class="mf">8.8000368331709111e-01</span><span class="p">,</span>
                                    <span class="mf">8.8065665428441120e-01</span><span class="p">,</span>   <span class="mf">8.8304706460276905e-01</span><span class="p">])</span>

<span class="n">RGBIllum2SpecCyan_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.1334479663682135e+00</span><span class="p">,</span>   <span class="mf">1.1266762330194116e+00</span><span class="p">,</span>
                                    <span class="mf">1.1346827504710164e+00</span><span class="p">,</span>   <span class="mf">1.1357395805744794e+00</span><span class="p">,</span>
                                    <span class="mf">1.1356371830149636e+00</span><span class="p">,</span>   <span class="mf">1.1361152989346193e+00</span><span class="p">,</span>
                                    <span class="mf">1.1362179057706772e+00</span><span class="p">,</span>   <span class="mf">1.1364819652587022e+00</span><span class="p">,</span>
                                    <span class="mf">1.1355107110714324e+00</span><span class="p">,</span>   <span class="mf">1.1364060941199556e+00</span><span class="p">,</span>
                                    <span class="mf">1.1360363621722465e+00</span><span class="p">,</span>   <span class="mf">1.1360122641141395e+00</span><span class="p">,</span>
                                    <span class="mf">1.1354266882467030e+00</span><span class="p">,</span>   <span class="mf">1.1363099407179136e+00</span><span class="p">,</span>
                                    <span class="mf">1.1355450412632506e+00</span><span class="p">,</span>   <span class="mf">1.1353732327376378e+00</span><span class="p">,</span>
                                    <span class="mf">1.1349496420726002e+00</span><span class="p">,</span>   <span class="mf">1.1111113947168556e+00</span><span class="p">,</span>
                                    <span class="mf">9.0598740429727143e-01</span><span class="p">,</span>   <span class="mf">6.1160780787465330e-01</span><span class="p">,</span>
                                    <span class="mf">2.9539752170999634e-01</span><span class="p">,</span>   <span class="mf">9.5954200671150097e-02</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.1650792030826267e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.2144633073395025e-02</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.1148167569748318e-02</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.1997606668458151e-02</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.0506855475394852e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.9982745819542154e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">9.4722817708236418e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.5329541006658815e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">4.5428914028274488e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.2541015360921132e-02</span><span class="p">])</span>

<span class="n">RGBIllum2SpecMagenta_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0371892935878366e+00</span><span class="p">,</span>   <span class="mf">1.0587542891035364e+00</span><span class="p">,</span>
                                    <span class="mf">1.0767271213688903e+00</span><span class="p">,</span>   <span class="mf">1.0762706844110288e+00</span><span class="p">,</span>
                                    <span class="mf">1.0795289105258212e+00</span><span class="p">,</span>   <span class="mf">1.0743644742950074e+00</span><span class="p">,</span>
                                    <span class="mf">1.0727028691194342e+00</span><span class="p">,</span>   <span class="mf">1.0732447452056488e+00</span><span class="p">,</span>
                                    <span class="mf">1.0823760816041414e+00</span><span class="p">,</span>   <span class="mf">1.0840545681409282e+00</span><span class="p">,</span>
                                    <span class="mf">9.5607567526306658e-01</span><span class="p">,</span>   <span class="mf">5.5197896855064665e-01</span><span class="p">,</span>
                                    <span class="mf">8.4191094887247575e-02</span><span class="p">,</span>   <span class="mf">8.7940070557041006e-05</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">2.3086408335071251e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.1248136628651192e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">7.7297612754989586e-11</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.7270769006770834e-04</span><span class="p">,</span>
                                    <span class="mf">1.4466473094035592e-02</span><span class="p">,</span>   <span class="mf">2.5883116027169478e-01</span><span class="p">,</span>
                                    <span class="mf">5.2907999827566732e-01</span><span class="p">,</span>   <span class="mf">9.0966624097105164e-01</span><span class="p">,</span>
                                    <span class="mf">1.0690571327307956e+00</span><span class="p">,</span>   <span class="mf">1.0887326064796272e+00</span><span class="p">,</span>
                                    <span class="mf">1.0637622289511852e+00</span><span class="p">,</span>   <span class="mf">1.0201812918094260e+00</span><span class="p">,</span>
                                    <span class="mf">1.0262196688979945e+00</span><span class="p">,</span>   <span class="mf">1.0783085560613190e+00</span><span class="p">,</span>
                                    <span class="mf">9.8333849623218872e-01</span><span class="p">,</span>   <span class="mf">1.0707246342802621e+00</span><span class="p">,</span>
                                    <span class="mf">1.0634247770423768e+00</span><span class="p">,</span>   <span class="mf">1.0150875475729566e+00</span><span class="p">])</span>

<span class="n">RGBIllum2SpecYellow_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.7756958965811972e-03</span><span class="p">,</span>   <span class="mf">3.9673820990646612e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.4606936788606750e-04</span><span class="p">,</span>   <span class="mf">3.6198394557748065e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">2.5819258699309733e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.0133191628082274e-05</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">2.4437242866157116e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.8061419948038946e-05</span><span class="p">,</span>
                                    <span class="mf">4.9690301207540921e-02</span><span class="p">,</span>   <span class="mf">4.8515973574763166e-01</span><span class="p">,</span>
                                    <span class="mf">1.0295725854360589e+00</span><span class="p">,</span>   <span class="mf">1.0333210878457741e+00</span><span class="p">,</span>
                                    <span class="mf">1.0368102644026933e+00</span><span class="p">,</span>   <span class="mf">1.0364884018886333e+00</span><span class="p">,</span>
                                    <span class="mf">1.0365427939411784e+00</span><span class="p">,</span>   <span class="mf">1.0368595402854539e+00</span><span class="p">,</span>
                                    <span class="mf">1.0365645405660555e+00</span><span class="p">,</span>   <span class="mf">1.0363938240707142e+00</span><span class="p">,</span>
                                    <span class="mf">1.0367205578770746e+00</span><span class="p">,</span>   <span class="mf">1.0365239329446050e+00</span><span class="p">,</span>
                                    <span class="mf">1.0361531226427443e+00</span><span class="p">,</span>   <span class="mf">1.0348785007827348e+00</span><span class="p">,</span>
                                    <span class="mf">1.0042729660717318e+00</span><span class="p">,</span>   <span class="mf">8.4218486432354278e-01</span><span class="p">,</span>
                                    <span class="mf">7.3759394894801567e-01</span><span class="p">,</span>   <span class="mf">6.5853154500294642e-01</span><span class="p">,</span>
                                    <span class="mf">6.0531682444066282e-01</span><span class="p">,</span>   <span class="mf">5.9549794132420741e-01</span><span class="p">,</span>
                                    <span class="mf">5.9419261278443136e-01</span><span class="p">,</span>   <span class="mf">5.6517682326634266e-01</span><span class="p">,</span>
                                    <span class="mf">5.6061186014968556e-01</span><span class="p">,</span>   <span class="mf">5.8228610381018719e-01</span><span class="p">])</span>

<span class="n">RGBIllum2SpecRed_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.4711187157291841e-02</span><span class="p">,</span>   <span class="mf">5.5609066498303397e-02</span><span class="p">,</span>
                                    <span class="mf">6.0755873790918236e-02</span><span class="p">,</span>   <span class="mf">5.6232948615962369e-02</span><span class="p">,</span>
                                    <span class="mf">4.6169940535708678e-02</span><span class="p">,</span>   <span class="mf">3.8012808167818095e-02</span><span class="p">,</span>
                                    <span class="mf">2.4424225756670338e-02</span><span class="p">,</span>   <span class="mf">3.8983580581592181e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.6082252172734437e-04</span><span class="p">,</span>   <span class="mf">9.6493871255194652e-04</span><span class="p">,</span>
                                    <span class="mf">3.7341198051510371e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.3367389093135200e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">9.3533962256892034e-05</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.2354967412842033e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.4524548081687461e-04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.0047691915543731e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">4.9938587694693670e-04</span><span class="p">,</span>   <span class="mf">2.7255083540032476e-02</span><span class="p">,</span>
                                    <span class="mf">1.6067405906297061e-01</span><span class="p">,</span>   <span class="mf">3.5069788873150953e-01</span><span class="p">,</span>
                                    <span class="mf">5.7357465538418961e-01</span><span class="p">,</span>   <span class="mf">7.6392091890718949e-01</span><span class="p">,</span>
                                    <span class="mf">8.9144466740381523e-01</span><span class="p">,</span>   <span class="mf">9.6394609909574891e-01</span><span class="p">,</span>
                                    <span class="mf">9.8879464276016282e-01</span><span class="p">,</span>   <span class="mf">9.9897449966227203e-01</span><span class="p">,</span>
                                    <span class="mf">9.8605140403564162e-01</span><span class="p">,</span>   <span class="mf">9.9532502805345202e-01</span><span class="p">,</span>
                                    <span class="mf">9.7433478377305371e-01</span><span class="p">,</span>   <span class="mf">9.9134364616871407e-01</span><span class="p">,</span>
                                    <span class="mf">9.8866287772174755e-01</span><span class="p">,</span>   <span class="mf">9.9713856089735531e-01</span><span class="p">])</span>

<span class="n">RGBIllum2SpecGreen_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.5168388755514630e-02</span><span class="p">,</span>   <span class="mf">3.9427438169423720e-02</span><span class="p">,</span>
                                    <span class="mf">6.2059571596425793e-03</span><span class="p">,</span>   <span class="mf">7.1120859807429554e-03</span><span class="p">,</span>
                                    <span class="mf">2.1760044649139429e-04</span><span class="p">,</span>   <span class="mf">7.3271839984290210e-12</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">2.1623066217181700e-02</span><span class="p">,</span>   <span class="mf">1.5670209409407512e-02</span><span class="p">,</span>
                                    <span class="mf">2.8019603188636222e-03</span><span class="p">,</span>   <span class="mf">3.2494773799897647e-01</span><span class="p">,</span>
                                    <span class="mf">1.0164917292316602e+00</span><span class="p">,</span>   <span class="mf">1.0329476657890369e+00</span><span class="p">,</span>
                                    <span class="mf">1.0321586962991549e+00</span><span class="p">,</span>   <span class="mf">1.0358667411948619e+00</span><span class="p">,</span>
                                    <span class="mf">1.0151235476834941e+00</span><span class="p">,</span>   <span class="mf">1.0338076690093119e+00</span><span class="p">,</span>
                                    <span class="mf">1.0371372378155013e+00</span><span class="p">,</span>   <span class="mf">1.0361377027692558e+00</span><span class="p">,</span>
                                    <span class="mf">1.0229822432557210e+00</span><span class="p">,</span>   <span class="mf">9.6910327335652324e-01</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">5.1785923899878572e-03</span><span class="p">,</span>   <span class="mf">1.1131261971061429e-03</span><span class="p">,</span>
                                    <span class="mf">6.6675503033011771e-03</span><span class="p">,</span>   <span class="mf">7.4024315686001957e-04</span><span class="p">,</span>
                                    <span class="mf">2.1591567633473925e-02</span><span class="p">,</span>   <span class="mf">5.1481620056217231e-03</span><span class="p">,</span>
                                    <span class="mf">1.4561928645728216e-03</span><span class="p">,</span>   <span class="mf">1.6414511045291513e-04</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">6.4630764968453287e-03</span><span class="p">,</span>   <span class="mf">1.0250854718507939e-02</span><span class="p">,</span>
                                    <span class="mf">4.2387394733956134e-02</span><span class="p">,</span>   <span class="mf">2.1252716926861620e-02</span><span class="p">])</span>

<span class="n">RGBIllum2SpecBlue_entries</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0570490759328752e+00</span><span class="p">,</span>   <span class="mf">1.0538466912851301e+00</span><span class="p">,</span>
                                    <span class="mf">1.0550494258140670e+00</span><span class="p">,</span>   <span class="mf">1.0530407754701832e+00</span><span class="p">,</span>
                                    <span class="mf">1.0579930596460185e+00</span><span class="p">,</span>   <span class="mf">1.0578439494812371e+00</span><span class="p">,</span>
                                    <span class="mf">1.0583132387180239e+00</span><span class="p">,</span>   <span class="mf">1.0579712943137616e+00</span><span class="p">,</span>
                                    <span class="mf">1.0561884233578465e+00</span><span class="p">,</span>   <span class="mf">1.0571399285426490e+00</span><span class="p">,</span>
                                    <span class="mf">1.0425795187752152e+00</span><span class="p">,</span>   <span class="mf">3.2603084374056102e-01</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.9255628442412243e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.2959221137046478e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.4357356276938696e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.2963697250337886e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.9227081162373899e-03</span><span class="p">,</span>   <span class="mf">1.2621152526221778e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.6095249003578276e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.3029983817879568e-03</span><span class="p">,</span>
                                    <span class="o">-</span><span class="mf">1.7666600873954916e-03</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.2325281140280050e-03</span><span class="p">,</span>
                                    <span class="mf">1.0316809673254932e-02</span><span class="p">,</span>   <span class="mf">3.1284512648354357e-02</span><span class="p">,</span>
                                    <span class="mf">8.8773879881746481e-02</span><span class="p">,</span>   <span class="mf">1.3873621740236541e-01</span><span class="p">,</span>
                                    <span class="mf">1.5535067531939065e-01</span><span class="p">,</span>   <span class="mf">1.4878477178237029e-01</span><span class="p">,</span>
                                    <span class="mf">1.6624255403475907e-01</span><span class="p">,</span>   <span class="mf">1.6997613960634927e-01</span><span class="p">,</span>
                                    <span class="mf">1.5769743995852967e-01</span><span class="p">,</span>   <span class="mf">1.9069090525482305e-01</span><span class="p">])</span>

<span class="n">rgb2spec_entries</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wlr&#39;</span><span class="p">:</span> <span class="n">RGB2Spec_wavelengths</span><span class="p">,</span> 
              <span class="s1">&#39;rfl&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;white&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecWhite_entries</span><span class="p">,</span>
                      <span class="s1">&#39;cyan&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecCyan_entries</span><span class="p">,</span>
                      <span class="s1">&#39;magenta&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecMagenta_entries</span><span class="p">,</span>
                      <span class="s1">&#39;yellow&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecYellow_entries</span><span class="p">,</span>
                      <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecBlue_entries</span><span class="p">,</span>
                      <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecGreen_entries</span><span class="p">,</span>
                      <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="n">RGBRefl2SpecRed_entries</span><span class="p">,</span>
                      <span class="s1">&#39;scalefactor&#39;</span> <span class="p">:</span> <span class="mf">0.94</span><span class="p">},</span>
              <span class="s1">&#39;spd&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;white&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecWhite_entries</span><span class="p">,</span>
                      <span class="s1">&#39;cyan&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecCyan_entries</span><span class="p">,</span>
                      <span class="s1">&#39;magenta&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecMagenta_entries</span><span class="p">,</span>
                      <span class="s1">&#39;yellow&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecYellow_entries</span><span class="p">,</span>
                      <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecBlue_entries</span><span class="p">,</span>
                      <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecGreen_entries</span><span class="p">,</span>
                      <span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="n">RGBIllum2SpecRed_entries</span><span class="p">,</span>
                      <span class="s1">&#39;scalefactor&#39;</span> <span class="p">:</span> <span class="mf">0.86445</span><span class="p">}}</span>
              
<span class="k">def</span> <span class="nf">_addwlr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">rgb2spec_entries</span><span class="p">[</span><span class="s1">&#39;wlr&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">_convert_to_wlr</span><span class="p">(</span><span class="n">entries</span> <span class="o">=</span> <span class="n">rgb2spec_entries</span><span class="p">,</span> <span class="n">wlr</span> <span class="o">=</span> <span class="n">_WL3</span><span class="p">):</span>
    <span class="n">wlr</span> <span class="o">=</span> <span class="n">getwlr</span><span class="p">(</span><span class="n">wlr</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="o">!=</span> <span class="s1">&#39;wlr&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;scalefactor&#39;</span><span class="p">:</span>
                    <span class="n">entries</span><span class="p">[</span><span class="n">entry</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">cie_interp</span><span class="p">(</span><span class="n">_addwlr</span><span class="p">(</span><span class="n">entries</span><span class="p">[</span><span class="n">entry</span><span class="p">][</span><span class="n">k</span><span class="p">]),</span> <span class="n">wlr</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="n">entry</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">entries</span><span class="p">[</span><span class="s1">&#39;wlr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wlr</span>
    <span class="k">return</span> <span class="n">entries</span>
    
<span class="n">rgb2spec_entries</span> <span class="o">=</span> <span class="n">_convert_to_wlr</span><span class="p">()</span>
<span class="n">_BASESPEC_SMITS</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rgb2spec_entries</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">_fromLinearRGB</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">intent</span> <span class="o">=</span> <span class="s1">&#39;rfl&#39;</span><span class="p">,</span> <span class="n">rgb2spec</span> <span class="o">=</span> <span class="n">_BASESPEC_SMITS</span><span class="p">,</span> <span class="n">wlr</span> <span class="o">=</span> <span class="n">_WL3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Get rfl estimates from lunearized RGB values&quot;&quot;&quot;</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">rgb</span> 
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rgb2spec</span><span class="p">[</span><span class="s1">&#39;wlr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">g</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># Compute reflectance spectrum with &#39;r&#39; as minimum</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;white&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">g</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">g</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;cyan&#39;</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;cyan&#39;</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">g</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>
        
    <span class="k">elif</span> <span class="p">(</span><span class="n">g</span> <span class="o">&lt;=</span> <span class="n">r</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">g</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">):</span>
        <span class="c1"># Compute reflectance spectrum with &#39;g&#39; as minimum</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;white&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;magenta&#39;</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;magenta&#39;</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;red&#39;</span><span class="p">]</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Compute reflectance spectrum with &#39;b&#39; as minimum</span>
        <span class="n">result</span> <span class="o">+=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;white&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">g</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;yellow&#39;</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">g</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">g</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;yellow&#39;</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;red&#39;</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">*=</span> <span class="n">rgb2spec</span><span class="p">[</span><span class="n">intent</span><span class="p">][</span><span class="s1">&#39;scalefactor&#39;</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># no negative values allowed</span>

<div class="viewcode-block" id="rgb_to_spec_smits">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.rgb2spec.rgb_to_spec_smits">[docs]</a>
<span class="k">def</span> <span class="nf">rgb_to_spec_smits</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span> <span class="n">intent</span> <span class="o">=</span> <span class="s1">&#39;rfl&#39;</span><span class="p">,</span>  <span class="n">linearized_rgb</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">bitdepth</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">wlr</span> <span class="o">=</span> <span class="n">_WL3</span><span class="p">,</span> <span class="n">rgb2spec</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert an array of (linearized) RGB values to a spectrum using a Smits like conversion as implemented in Mitsuba.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        :rgb: </span>
<span class="sd">            | ndarray of list of (linearized) rgb values</span>
<span class="sd">        :linearized_rgb:</span>
<span class="sd">            | True, optional</span>
<span class="sd">            | If False: RGB values will be linearized using:</span>
<span class="sd">            |     rgb_lin = xyz_to_srgb(srgb_to_xyz(rgb), gamma = 1, use_linear_part = False)</span>
<span class="sd">            | If True: user has entered pre-linearized RGB values. </span>
<span class="sd">        :intent:</span>
<span class="sd">            | &#39;rfl&#39; (or &#39;spd&#39;), optional</span>
<span class="sd">            | type of requested spectrum conversion.</span>
<span class="sd">        :bitdepth:</span>
<span class="sd">            | 8, optional</span>
<span class="sd">            | bit depth of rgb values</span>
<span class="sd">        :wlr: </span>
<span class="sd">            | _WL3, optional</span>
<span class="sd">            | desired wavelength (nm) range of spectrum.</span>
<span class="sd">        :rgb2spec:</span>
<span class="sd">            | None, optional</span>
<span class="sd">            | Dict with base spectra for white, cyan, magenta, yellow, blue, green and red for each intent.</span>
<span class="sd">            | If None: use _BASESPEC_SMITS.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        :spec: </span>
<span class="sd">            | ndarray with spectrum or spectra (one for each rgb value, first row are the wavelengths)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rgb</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
        <span class="n">rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">rgb</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rgb</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">bitdepth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">linearized_rgb</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">rgb</span> <span class="o">=</span> <span class="n">xyz_to_srgb</span><span class="p">(</span><span class="n">srgb_to_xyz</span><span class="p">(</span><span class="n">rgb</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">use_linear_part</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">/</span><span class="mf">255.0</span>
    <span class="k">if</span> <span class="n">rgb2spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rgb2spec</span> <span class="o">=</span> <span class="n">_BASESPEC_SMITS</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">rgb2spec</span><span class="p">[</span><span class="s1">&#39;wlr&#39;</span><span class="p">],</span> <span class="n">getwlr</span><span class="p">(</span><span class="n">wlr</span><span class="p">)):</span>
        <span class="n">rgb2spec</span> <span class="o">=</span> <span class="n">_convert_to_wlr</span><span class="p">(</span><span class="n">entries</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">rgb2spec</span><span class="p">),</span> <span class="n">wlr</span> <span class="o">=</span> <span class="n">wlr</span><span class="p">)</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rgb2spec</span><span class="p">[</span><span class="s1">&#39;wlr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">_fromLinearRGB</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">intent</span><span class="p">,</span> <span class="n">rgb2spec</span> <span class="o">=</span> <span class="n">rgb2spec</span><span class="p">,</span> <span class="n">wlr</span> <span class="o">=</span> <span class="n">wlr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">rgb2spec</span><span class="p">[</span><span class="s1">&#39;wlr&#39;</span><span class="p">],</span><span class="n">spec</span><span class="p">))</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">luxpy</span> <span class="k">as</span> <span class="nn">lx</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">rfl</span> <span class="o">=</span> <span class="n">rgb_to_spec_smits</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">]],</span> <span class="n">wlr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span><span class="mi">830</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">lx</span><span class="o">.</span><span class="n">SPD</span><span class="p">(</span><span class="n">rfl</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;linearized rgb input&#39;</span><span class="p">)</span>
    <span class="n">rfl</span> <span class="o">=</span> <span class="n">rgb_to_spec_smits</span><span class="p">([[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">]],</span> <span class="n">wlr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span><span class="mi">830</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">linearized_rgb</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">lx</span><span class="o">.</span><span class="n">SPD</span><span class="p">(</span><span class="n">rfl</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;non-linearized rgb input&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Kevin A.G. Smet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>