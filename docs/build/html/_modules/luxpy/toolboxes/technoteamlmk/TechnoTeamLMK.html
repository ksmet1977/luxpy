

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>luxpy.toolboxes.technoteamlmk.TechnoTeamLMK &mdash; LuxPy 1.12.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=a687bbd5"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            LuxPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License: GPLv3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../required_packages.html">Imported (required) packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../luxpy_structure.html">Luxpy package structure</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">LuxPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">luxpy.toolboxes.technoteamlmk.TechnoTeamLMK</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for luxpy.toolboxes.technoteamlmk.TechnoTeamLMK</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for TechnoTeam LMK camera basic control</span>
<span class="sd">==============================================</span>

<span class="sd"> * lmkActiveX: class for basic LMK control </span>
<span class="sd"> </span>
<span class="sd"> * _CAMERAS: dictionary with supported camera-lens combinations </span>
<span class="sd"> </span>
<span class="sd"> * define_lens(): to define new lens dictionary</span>
<span class="sd"> </span>
<span class="sd"> * kill_lmk4_process(): kill the lmk4.exe process in case some error happens </span>
<span class="sd"> </span>
<span class="sd"> * read_pcf(): read TechnoTeam pcf file. (output = CIE-RGB)</span>
<span class="sd"> </span>
<span class="sd"> * write_pcf(): write a basic TechnoTeam PCF file. (input = CIE-RGB)</span>
<span class="sd"> </span>
<span class="sd"> * plot_pcf(): make a plot of a pcf image. </span>

<span class="sd"> * pcf_to_xyz(): convert pcf image to an XYZ image</span>
<span class="sd"> </span>
<span class="sd"> * xyz_to_pcf(): convert an xyz image to a TechnoTeam PCF</span>

<span class="sd"> * ciergb_to_xyz(): convert CIE-RGB to XYZ </span>
<span class="sd"> </span>
<span class="sd"> * xyz_to_ciergb(): convert XYZ to CIE-RGB</span>

<span class="sd">Created on Sat Nov 26 10:52:42 2022</span>

<span class="sd">@author: ksmet1977</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">configparser</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">luxpy.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_importable</span>


<span class="c1"># import win32 (and if necessary install it):</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">is_importable</span><span class="p">(</span><span class="s1">&#39;win32&#39;</span><span class="p">,</span> <span class="n">pip_string</span> <span class="o">=</span> <span class="s1">&#39;pywin32&#39;</span><span class="p">,</span> <span class="n">try_pip_install</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">success</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">win32</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">win32com.client</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dispatch</span> <span class="c1"># pip install pywin32</span>

<span class="c1"># import easygui(and if necessary install it):</span>
<span class="n">success</span> <span class="o">=</span> <span class="n">is_importable</span><span class="p">(</span><span class="s1">&#39;easygui&#39;</span><span class="p">,</span> <span class="n">try_pip_install</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">success</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">easygui</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_LABSOFT_PATH&#39;</span><span class="p">,</span><span class="s1">&#39;_LABSOFT_CAMERA_PATH&#39;</span><span class="p">,</span><span class="s1">&#39;_CAMERAS&#39;</span><span class="p">,</span>
           <span class="s1">&#39;get_labsoft_path&#39;</span><span class="p">,</span><span class="s1">&#39;define_lens&#39;</span><span class="p">,</span> <span class="s1">&#39;lmkActiveX&#39;</span><span class="p">,</span> <span class="s1">&#39;kill_lmk4_process&#39;</span><span class="p">,</span>
           <span class="s1">&#39;read_pcf&#39;</span><span class="p">,</span> <span class="s1">&#39;write_pcf&#39;</span><span class="p">,</span> <span class="s1">&#39;plot_pcf&#39;</span><span class="p">,</span> <span class="s1">&#39;pcf_to_xyz&#39;</span><span class="p">,</span> <span class="s1">&#39;xyz_to_pcf&#39;</span><span class="p">,</span>
           <span class="s1">&#39;ciergb_to_xyz&#39;</span><span class="p">,</span><span class="s1">&#39;xyz_to_ciergb&#39;</span><span class="p">]</span>

<span class="c1">#------------------------------------------------------------------------------</span>
<span class="c1">#_LABSOFT_PATH = r&#39;C:/TechnoTeam/LabSoft/&#39;</span>

<div class="viewcode-block" id="get_labsoft_path">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.get_labsoft_path">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_labsoft_path</span><span class="p">():</span>
    <span class="n">labsoft_path_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span><span class="s1">&#39;labsoft_path.txt&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">labsoft_path_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
       <span class="n">labsoft_path</span> <span class="o">=</span> <span class="n">fid</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labsoft_path</span><span class="p">,</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span><span class="s1">&#39;lmk4.exe&#39;</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Could not find </span><span class="si">{:s}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">labsoft_path</span><span class="p">,</span><span class="s1">&#39;bin&#39;</span><span class="p">,</span><span class="s1">&#39;lmk4.exe&#39;</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Make sure the installation path of the labsoft software package in file </span><span class="si">{:s}</span><span class="s1"> is correct.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labsoft_path_file</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span>
    <span class="k">return</span> <span class="n">labsoft_path</span></div>


<span class="n">_LABSOFT_PATH</span> <span class="o">=</span> <span class="n">get_labsoft_path</span><span class="p">()</span>
<span class="n">_LABSOFT_CAMERA_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_LABSOFT_PATH</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;Camera&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>



<span class="c1">#==============================================================================</span>
<span class="c1"># Helper functions / classes</span>
<span class="c1">#============================================================================== </span>


<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="define_lens">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.define_lens">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">define_lens</span><span class="p">(</span><span class="n">lens_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">focusFactors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Define a technoteam lens &quot;&quot;&quot;</span>
    <span class="n">lens</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">focusFactors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ff_base</span> <span class="o">=</span> <span class="n">lens_type</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">lens_type</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ff_base</span> <span class="o">=</span> <span class="n">ff_base</span><span class="p">[:</span><span class="n">ff_base</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)]</span>
        <span class="n">ff_base</span> <span class="o">=</span> <span class="s1">&#39;TT&#39;</span> <span class="o">+</span> <span class="n">ff_base</span> <span class="o">+</span> <span class="s1">&#39;Scale&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">focusFactors</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">focusFactors</span> <span class="o">=</span> <span class="p">([</span><span class="s1">&#39;</span><span class="si">{:02.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">focusFactors</span><span class="p">)],[</span><span class="n">focusFactors</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">focusFactors</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="n">focusFactors</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">focusFactors</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">focusFactors</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">focusFactors</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="n">focusFactors_str</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">focusFactors</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">ff</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;</span><span class="si">{:02.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
                <span class="n">focusFactors_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
            <span class="n">focusFactors</span> <span class="o">=</span> <span class="p">(</span><span class="n">focusFactors_str</span><span class="p">,[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">focusFactors_str</span><span class="p">))])</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;</span><span class="si">{:s}{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ff_base</span><span class="p">,</span><span class="n">i</span><span class="p">))</span> <span class="p">:</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">focusFactors</span><span class="p">)}</span>
        <span class="n">lens</span><span class="p">[</span><span class="s1">&#39;focusFactors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
    <span class="k">return</span> <span class="n">lens</span></div>


<span class="c1">#------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="kill_lmk4_process">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.kill_lmk4_process">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">kill_lmk4_process</span><span class="p">(</span><span class="n">verbosity</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;taskkill&quot;</span><span class="p">,</span> <span class="s2">&quot;/F&quot;</span><span class="p">,</span> <span class="s2">&quot;/IM&quot;</span><span class="p">,</span> <span class="s2">&quot;lmk4.exe&quot;</span><span class="p">],</span> <span class="n">capture_output</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="c1"># use: C:\Windows\System32\taskkill ?</span>
                          <span class="n">stderr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span></div>



<span class="c1">#==============================================================================</span>
<span class="c1"># LMK control </span>
<span class="c1">#============================================================================== </span>
<span class="c1"># Define supported cameras and lenses:</span>
    
    
<span class="n">_CAMERAS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ttf8847&#39;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="s1">&#39;name&#39;</span>   <span class="p">:</span> <span class="s1">&#39;ttf8847&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;lenses&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x6_5mm&#39;</span> <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x6_5mm&#39;</span><span class="p">,</span><span class="s1">&#39;o13196f6_5&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
                                        <span class="s1">&#39;x12mm&#39;</span>  <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x12mm&#39;</span><span class="p">,</span><span class="s1">&#39;o95653f12&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0_3&#39;</span><span class="p">,</span><span class="s1">&#39;0_5&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;Infinite&#39;</span><span class="p">]),</span>
                                        <span class="s1">&#39;x25mm&#39;</span>  <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x25mm&#39;</span><span class="p">,</span><span class="s1">&#39;oB225463f25&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]),</span>
                                        <span class="s1">&#39;x50mm&#39;</span>  <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x50mm&#39;</span><span class="p">,</span><span class="s1">&#39;oC216813f50&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)])</span>
                                        <span class="p">}</span>
                        <span class="p">},</span>
    
            <span class="s1">&#39;tts20035&#39;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;name&#39;</span>   <span class="p">:</span> <span class="s1">&#39;tts20035&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;lenses&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x50mm_M00442&#39;</span>   <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x50mm_M00442&#39;</span><span class="p">,</span><span class="s1">&#39;oM00442f50&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)]),</span>
                                    <span class="s1">&#39;x12mm_TTC_163&#39;</span>  <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x12mm_TTC_163&#39;</span><span class="p">,</span><span class="s1">&#39;oTTC-163_D0224&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
                                    <span class="s1">&#39;x12f50mm_2mm&#39;</span>   <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x12f50mm_2mm&#39;</span><span class="p">,</span><span class="s1">&#39;oTTNED-12_50_2mmEP&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
                                    <span class="s1">&#39;x12f50mm_4mm&#39;</span>   <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;x12f50mm_4mm&#39;</span><span class="p">,</span><span class="s1">&#39;oTTNED-12_50_4mmEP&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">),</span>
                                    <span class="s1">&#39;xvr&#39;</span>            <span class="p">:</span> <span class="n">define_lens</span><span class="p">(</span><span class="s1">&#39;xvr&#39;</span><span class="p">,</span><span class="s1">&#39;oTTC-163_D0224&#39;</span><span class="p">,</span><span class="n">focusFactors</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>    
                                    <span class="p">}</span>

                         <span class="p">}</span>
            <span class="p">}</span>


<div class="viewcode-block" id="lmkActiveX">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">lmkActiveX</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Class for TechnoTeam LMK camera basic control</span>
<span class="sd">    </span>
<span class="sd">    All supported camera/lens combinations are defined in: _CAMERAS</span>
<span class="sd">    To add new ones (or new lenses): edit the_CAMERAS dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># main object containing the lmk ActiveX server object</span>
    <span class="n">lmk</span> <span class="o">=</span> <span class="kc">None</span> 
    
    <span class="c1"># Verbosity level:</span>
    <span class="n">verbosity_levels</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span> <span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                        <span class="mi">1</span> <span class="p">:</span> <span class="s1">&#39;minimal&#39;</span><span class="p">,</span>
                        <span class="mi">2</span> <span class="p">:</span> <span class="s1">&#39;moderate (default)&#39;</span><span class="p">,</span>
                        <span class="mi">3</span> <span class="p">:</span> <span class="s1">&#39;Detailed&#39;</span><span class="p">,</span>
                        <span class="mi">4</span> <span class="p">:</span> <span class="s1">&#39;All&#39;</span>
                       <span class="p">}</span>
    <span class="n">verbosity</span> <span class="o">=</span> <span class="mi">2</span>
        
    <span class="n">workingImage</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">errorFlag</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">colorSpace</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;CIE-RGB&#39;</span>       <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;S-RGB&#39;</span>         <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;EBU-RGB&#39;</span>       <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s1">&#39;XYZ&#39;</span>           <span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="s1">&#39;Lxy&#39;</span>           <span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
                <span class="s1">&#39;Luv&#39;</span>           <span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
                <span class="s1">&#39;Lu_v_&#39;</span>         <span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
                <span class="s1">&#39;L*u*v*&#39;</span>        <span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
                <span class="s1">&#39;C*h*s*_uv&#39;</span>     <span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
                <span class="s1">&#39;L*a*b*&#39;</span>        <span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
                <span class="s1">&#39;C*h*_ab&#39;</span>       <span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
                <span class="s1">&#39;HSV&#39;</span>           <span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
                <span class="s1">&#39;HSI&#39;</span>           <span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
                <span class="s1">&#39;WST&#39;</span>           <span class="p">:</span> <span class="mi">16384</span><span class="p">,</span>
                <span class="s1">&#39;Lrg&#39;</span>           <span class="p">:</span> <span class="mi">32768</span><span class="p">,</span>
                <span class="s1">&#39;LWS&#39;</span>           <span class="p">:</span> <span class="mi">65536</span>
                <span class="p">}</span>
                
    <span class="n">imageType</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Camera&#39;</span>        <span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;Luminance&#39;</span>     <span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;Color&#39;</span>         <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;Evaluation[1]&#39;</span> <span class="p">:</span>  <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;Evaluation[2]&#39;</span> <span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;Evaluation[3]&#39;</span> <span class="p">:</span>  <span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;Evaluation[4]&#39;</span> <span class="p">:</span>  <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;Evaluation[5]&#39;</span> <span class="p">:</span>  <span class="mi">4</span>
                <span class="p">}</span>

    <span class="n">regionType</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;Rectangle&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">2</span>
                    <span class="p">},</span>
                <span class="s1">&#39;Line&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">2</span>
                    <span class="p">},</span>
                <span class="s1">&#39;Circle&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">2</span>
                    <span class="p">},</span>
                <span class="s1">&#39;Polygon&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">3</span>
                    <span class="p">},</span>
                <span class="s1">&#39;Polyline&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">3</span>
                    <span class="p">},</span>
                <span class="s1">&#39;Ellipse&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">3</span>
                    <span class="p">},</span>
                <span class="s1">&#39;CircularRing&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">3</span>
                    <span class="p">},</span>
                <span class="s1">&#39;OR&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">2</span>
                    <span class="p">},</span>
                <span class="s1">&#39;XOR&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">2</span>
                    <span class="p">},</span>
                <span class="s1">&#39;AND&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;identifier&#39;</span>    <span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
                    <span class="s1">&#39;points&#39;</span>        <span class="p">:</span> <span class="mi">2</span>
                    <span class="p">}</span>
                <span class="p">}</span>
    
    <span class="n">statisticType</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;standardGrey&#39;</span>          <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1"># 0 	Standard statistic in grey images</span>
                    <span class="s1">&#39;standardColor&#39;</span>         <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># 1 	Standard statistic in color images</span>
                    <span class="s1">&#39;sectionalGrey&#39;</span>         <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>   <span class="c1"># 2 	Sectional view in grey images</span>
                    <span class="s1">&#39;sectionalColor&#39;</span>        <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>   <span class="c1"># 3 	Sectional view in color images</span>
                    <span class="s1">&#39;histogramGrey&#39;</span>         <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>   <span class="c1"># 4 	Histogram in grey images</span>
                    <span class="s1">&#39;histogramColor&#39;</span>        <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>   <span class="c1"># 5 	Histogram in color images</span>
                    <span class="s1">&#39;bitHistogramGrey&#39;</span>      <span class="p">:</span> <span class="mi">6</span><span class="p">,</span>   <span class="c1"># 6 	Bit histogram in grey images (only images of camera image type)</span>
                    <span class="s1">&#39;bitHistorgramColor&#39;</span>    <span class="p">:</span> <span class="mi">7</span><span class="p">,</span>   <span class="c1"># 7 	Bit histogram in color images (only images of color camera image type)</span>
                    <span class="s1">&#39;projectionGrey&#39;</span>        <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>   <span class="c1"># 8 	Projection in grey images</span>
                    <span class="s1">&#39;projectionColor&#39;</span>       <span class="p">:</span> <span class="mi">9</span><span class="p">,</span>   <span class="c1"># 9 	Projection in color images</span>
                    <span class="s1">&#39;luminanceGrey&#39;</span>         <span class="p">:</span><span class="mi">20</span><span class="p">,</span>   <span class="c1"># 20 Luminance objects in grey images</span>
                    <span class="s1">&#39;integralGrey&#39;</span>          <span class="p">:</span><span class="mi">22</span><span class="p">,</span>   <span class="c1"># 22 Integral objects in grey images</span>
                    <span class="s1">&#39;integralColor&#39;</span>         <span class="p">:</span><span class="mi">23</span><span class="p">,</span>   <span class="c1"># 23 Integral objects in color images</span>
                    <span class="s1">&#39;symbolGrey&#39;</span>            <span class="p">:</span><span class="mi">24</span><span class="p">,</span>   <span class="c1"># 24 Symbol objects in grey images</span>
                    <span class="s1">&#39;symbolColor&#39;</span>           <span class="p">:</span><span class="mi">25</span><span class="p">,</span>   <span class="c1"># 25 Symbol objects in color images</span>
                    <span class="s1">&#39;lightArcGrey&#39;</span>          <span class="p">:</span><span class="mi">26</span><span class="p">,</span>   <span class="c1"># 26 Light arc objects in grey images</span>
                    <span class="s1">&#39;spiralWoundGrey&#39;</span>       <span class="p">:</span><span class="mi">28</span><span class="p">,</span>   <span class="c1"># 28 Spiralwoundfilaments in grey images</span>
                    <span class="s1">&#39;chromaticityLineColor&#39;</span> <span class="p">:</span><span class="mi">31</span><span class="p">,</span>   <span class="c1"># 31 Chromaticity line diagrams in color images</span>
                    <span class="s1">&#39;chromaticityAreaColor&#39;</span> <span class="p">:</span><span class="mi">33</span><span class="p">,</span>   <span class="c1"># 33 Chromaticity area diagrams in color images</span>
                    <span class="s1">&#39;threeDviewGrey&#39;</span>        <span class="p">:</span><span class="mi">34</span><span class="p">,</span>   <span class="c1"># 34 3d view in grey images</span>
                    <span class="s1">&#39;integralNegativeGrey&#39;</span>  <span class="p">:</span><span class="mi">36</span><span class="p">,</span>   <span class="c1"># 36 Integral objects in grey images (negative contrast)</span>
                    <span class="s1">&#39;integralNegativeColor&#39;</span> <span class="p">:</span><span class="mi">38</span><span class="p">,</span>   <span class="c1"># 38 Symbol objects in grey images (negative contrast)</span>
                    <span class="s1">&#39;symbolNegativeColor&#39;</span>   <span class="p">:</span><span class="mi">39</span><span class="p">,</span>   <span class="c1"># 39 Symbol objects in color images (negative contrast)</span>
                    <span class="s1">&#39;contrastGrey&#39;</span>          <span class="p">:</span><span class="mi">40</span>    <span class="c1"># 40 Contrasts objects in grey images</span>
                    <span class="p">}</span>
                    
    <span class="n">camera</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">_CAMERAS</span><span class="p">)</span>

            
    <span class="c1"># properties capture images</span>
    <span class="n">captureStartRatio</span>       <span class="o">=</span> <span class="mi">10</span>
    <span class="n">captureMaxTries</span>         <span class="o">=</span>  <span class="mi">3</span>
    <span class="n">captureFactor</span>           <span class="o">=</span>  <span class="mi">3</span>
    <span class="n">captureCountPic</span>         <span class="o">=</span>  <span class="mi">1</span>
    <span class="n">captureDefaultMaxTries</span>  <span class="o">=</span>  <span class="mi">3</span>
        
    <span class="n">boolStr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;False&#39;</span><span class="p">,</span> <span class="s1">&#39;True&#39;</span><span class="p">]</span>
    
    <span class="c1"># constructor method</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">camera</span><span class="p">,</span> <span class="n">lens</span><span class="p">,</span><span class="n">focusfactor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">modfrequency</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                 <span class="n">labsoft_camera_path</span> <span class="o">=</span> <span class="n">_LABSOFT_CAMERA_PATH</span><span class="p">,</span> 
                 <span class="n">verbosity</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
                 
        <span class="n">bool2num</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span> 

        <span class="c1"># process camera and lens input:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">camera</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span> <span class="c1"># so user can have a look at implemented camera&#39;s</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span><span class="p">[</span><span class="n">camera</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span>  <span class="k">else</span> <span class="n">camera</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lens</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> 
            <span class="k">if</span> <span class="n">lens</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span><span class="p">[</span><span class="s1">&#39;lenses&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">lens</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span><span class="p">[</span><span class="s1">&#39;lenses&#39;</span><span class="p">][</span><span class="n">lens</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Lens </span><span class="si">{:s}</span><span class="s1"> not in lensList for camera </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lens</span><span class="p">,</span> <span class="n">camera</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lens</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">lens</span> <span class="o">=</span> <span class="n">lens</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span> <span class="p">(</span><span class="s1">&#39;lens must be str or dict object&#39;</span><span class="p">)</span>
                    
        <span class="bp">cls</span><span class="o">.</span><span class="n">focusfactor</span> <span class="o">=</span> <span class="n">focusfactor</span> 
        <span class="bp">cls</span><span class="o">.</span><span class="n">autoscan</span> <span class="o">=</span> <span class="n">bool2num</span><span class="p">(</span><span class="n">autoscan</span><span class="p">)</span> <span class="c1"># Determination of a good exposure time before the capturing algorithm.</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">autoexposure</span> <span class="o">=</span> <span class="n">bool2num</span><span class="p">(</span><span class="n">autoexposure</span><span class="p">)</span> <span class="c1"># all exposure times will automatically adjusted if camera exposure time is reduced or enlarged.</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">modfrequency</span> <span class="o">=</span> <span class="n">modfrequency</span> 
        <span class="bp">cls</span><span class="o">.</span><span class="n">maxtime</span> <span class="o">=</span> <span class="n">maxtime</span>
        
        <span class="k">if</span> <span class="n">verbosity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="n">verbosity</span> 
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">labsoft_camera_path</span> <span class="o">=</span> <span class="n">labsoft_camera_path</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">objectiveCalibrationPath</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">labsoft_camera_path</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lens</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> 
        
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Already connected to LMK Labsoft ! Close connection first.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">objectiveCalibrationPath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Cannot connect to lmk with a not-None objectiveCalibrationPath !&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># initialize the lmk activeX software and object</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<div class="viewcode-block" id="lmkActiveX.show_labsoft_gui">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.show_labsoft_gui">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">show_labsoft_gui</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">show</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">show_gui</span> <span class="o">=</span> <span class="n">show</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iShow</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">show_gui</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: show_labsoft_gui(): Problem setting the visibility of the LabSoft GUI.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorText</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;errorText&#39;</span><span class="p">,</span><span class="n">errorText</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LabSoft error information: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">errorText</span><span class="p">))</span>
            
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span></div>

        
    
<div class="viewcode-block" id="lmkActiveX.open_lmk_labsoft_connection">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.open_lmk_labsoft_connection">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">open_lmk_labsoft_connection</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">objectiveCalibrationPath</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_gui</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a connection to LMK LabSoft.</span>

<span class="sd">          Input:</span>
<span class="sd">            - objectiveCalibrationPath: path to calibration file</span>
<span class="sd">          Output:</span>
<span class="sd">            - answer: 0=no error, other=error code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">objectiveCalibrationPath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objectiveCalibrationPath</span> <span class="o">=</span> <span class="n">objectiveCalibrationPath</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objectiveCalibrationPath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: open_lmk_labsoft_connection(): no objective path specified. Aborting...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="mi">171</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
                <span class="c1">#winsound.Beep(400,200)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span>
            
        <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Establish connection to LMK LabSoft via ActiveX-Server</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span> <span class="o">=</span> <span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;lmk4.LMKAxServer&#39;</span><span class="p">)</span>
        
        <span class="c1"># Open LabSoft, necessary command:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iOpen</span><span class="p">()</span>
        
        <span class="c1"># temporary fix for license issue:</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">==</span> <span class="mi">137363456</span><span class="p">):</span>
            <span class="n">easygui</span><span class="o">.</span><span class="n">msgbox</span><span class="p">(</span><span class="s1">&#39;When finished continue&#39;</span><span class="p">,</span> <span class="s1">&#39;Close dialog box in LabSoft GUI&#39;</span><span class="p">,</span> <span class="s1">&#39;continue&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span>
            
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: open_lmk_labsoft_connection(): Problem opening the LabSoft program. Aborting...</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorText</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;errorText&#39;</span><span class="p">,</span><span class="n">errorText</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LabSoft error information: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">errorText</span><span class="p">))</span>
            
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span>
        
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span></div>


    
<div class="viewcode-block" id="lmkActiveX.close_lmk_labsoft_connection">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.close_lmk_labsoft_connection">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">close_lmk_labsoft_connection</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">open_dialog</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the connection to LMK LabSoft and LabSoft itself.</span>

<span class="sd">        Input:</span>
<span class="sd">          - open_dialog:</span>
<span class="sd">                If 0: | No dialog window.</span>
<span class="sd">                Else: | Opens a dialog window in the Labsoft application.</span>
<span class="sd">                      | The user can choose whether they wish to save </span>
<span class="sd">                      | the current state or not or or cancel </span>
<span class="sd">                      | the closing of LabSoft.</span>
<span class="sd">                      </span>
<span class="sd">        Output:</span>
<span class="sd">          - answer: 0=no error, other=error code</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;close_lmk_labsoft_connection(): lmk is closed.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">&quot;&lt;class &#39;win32com.client.CDispatch&#39;&gt;&quot;</span><span class="p">:</span> <span class="c1"># original matlab: if (isa(obj.lmk, &#39;COM.lmk4_LMKAxServer&#39;) == 0)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: close_lmk_labsoft_connection(): lmk is not a LabSoft-Handle</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="mi">112</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Close program</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iClose</span><span class="p">(</span><span class="n">open_dialog</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: close_lmk_labsoft_connection(): Problem closing the program</span><span class="se">\n</span><span class="s1">.&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorText</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LabSoft error information: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">errorText</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: close_lmk_labsoft_connection(): Problem closing the program</span><span class="se">\n</span><span class="s1">.&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorText</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LabSoft error information: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">errorText</span><span class="p">))</span>
        
        <span class="k">del</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># kill the process of LabSoft to avoid complications at the next start</span>
        <span class="n">out_subprocess</span> <span class="o">=</span> <span class="n">kill_lmk4_process</span><span class="p">(</span><span class="n">verbosity</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="n">out_subprocess</span><span class="o">.</span><span class="n">returncode</span><span class="p">,</span> <span class="n">out_subprocess</span><span class="o">.</span><span class="n">stdout</span> <span class="o">+</span> <span class="n">out_subprocess</span><span class="o">.</span><span class="n">stderr</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: close_lmk_labsoft_connection(): Couldn&#39;t correctly close the program</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;subprocess error information: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span> <span class="o">=</span> <span class="mi">113</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Process killed succesfully!&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span></div>


    <span class="c1"># destructor method</span>
<div class="viewcode-block" id="lmkActiveX.delete">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.delete">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">open_dialog</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Delete lmk class object (close connection to labsoft) &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">close_lmk_labsoft_connection</span><span class="p">(</span><span class="n">open_dialog</span> <span class="o">=</span> <span class="n">open_dialog</span><span class="p">)</span></div>

        
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__del__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">open_dialog</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Delete lmk class object (close connection to labsoft) &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span> 
            <span class="bp">cls</span><span class="o">.</span><span class="n">close_lmk_labsoft_connection</span><span class="p">(</span><span class="n">open_dialog</span> <span class="o">=</span> <span class="n">open_dialog</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">close_lmk_labsoft_connection</span><span class="p">(</span><span class="n">open_dialog</span> <span class="o">=</span> <span class="n">open_dialog</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not delete lmkActiveX class object.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  Kill lmk4.exe process manually --&gt; run kill_lmk4_process()&#39;</span><span class="p">)</span>
        
<div class="viewcode-block" id="lmkActiveX.setWorkingImage">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.setWorkingImage">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setWorkingImage</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the current working image &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span> <span class="o">=</span> <span class="n">w</span></div>

        
    
<div class="viewcode-block" id="lmkActiveX.display_error_info">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.display_error_info">[docs]</a>
    <span class="nd">@classmethod</span>        
    <span class="k">def</span><span class="w"> </span><span class="nf">display_error_info</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">err_code</span><span class="p">,</span> <span class="n">process_id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the info for err_code and print &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">err_code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1"> ok!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">process_id</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error </span><span class="si">{:s}</span><span class="s1">: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">process_id</span><span class="p">))</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

    
<div class="viewcode-block" id="lmkActiveX.get_filter_wheel_info">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_filter_wheel_info">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_filter_wheel_info</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get max. number of filter wheels and their names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">labsoft_camera_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">camera</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;camera.ini&#39;</span><span class="p">)</span>
        <span class="n">filter_wheel_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PropertyList&#39;</span><span class="p">,</span> <span class="s1">&#39;FILTER_WHEEL_MAX&#39;</span><span class="p">))</span>
        <span class="n">filter_wheel_names</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PropertyList&#39;</span><span class="p">,</span> <span class="s1">&#39;FILTER_WHEEL_NAMES&#39;</span><span class="p">)</span>
        <span class="n">filter_wheel_names</span> <span class="o">=</span> <span class="n">filter_wheel_names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filter_wheel_names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">filter_wheel_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">filter_wheel_names</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filter_wheel_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">filter_wheel_names</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="n">filter_wheel_max</span><span class="p">,</span> <span class="n">filter_wheel_names</span></div>

    
<div class="viewcode-block" id="lmkActiveX.measureColorMultipic">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.measureColorMultipic">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">measureColorMultipic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">countPic</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Capture a ColorMultiPicture &quot;&quot;&quot;</span>
        <span class="n">currTries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">countPic</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">countPic</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">captureCountPic</span>
        <span class="k">if</span> <span class="n">defaultMaxTries</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">defaultMaxTries</span>
        
        <span class="c1"># Capture image</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting capturing ColorMultiPic image.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="c1"># Capture image</span>
        <span class="n">tempFlag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">currTries</span> <span class="o">&lt;=</span> <span class="n">defaultMaxTries</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tempFlag</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">tempFlag</span><span class="p">,</span> <span class="n">exposure_times</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iColorCaptureMultiPic</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">filter_wheel_max</span><span class="p">,</span><span class="n">countPic</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ColorMultiPic: image captured.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Filter wheel exposure times: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">exposure_times</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">currTries</span> <span class="o">=</span> <span class="n">currTries</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error ColorMultiPic: Try </span><span class="si">{:1.0f}</span><span class="s1">/</span><span class="si">{:1.0f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currTries</span><span class="p">,</span><span class="n">defaultMaxTries</span><span class="p">))</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Capture image failed!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

            

<div class="viewcode-block" id="lmkActiveX.saveImage">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.saveImage">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">saveImage</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">folderXYZ</span><span class="p">,</span><span class="n">fileNameXYZ</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Save the captured image currently as workingImage to the specified file and folder &quot;&quot;&quot;</span>
        <span class="n">imgPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folderXYZ</span><span class="p">,</span> <span class="n">fileNameXYZ</span> <span class="o">+</span> <span class="s1">&#39;.pcf&#39;</span><span class="p">)</span>
        <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSaveImage</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span><span class="n">imgPath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSaveImage: image saved: </span><span class="si">{:s}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imgPath</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSaveImage: error saving </span><span class="si">{:s}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imgPath</span><span class="p">))</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

            
<div class="viewcode-block" id="lmkActiveX.loadImage">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.loadImage">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loadImage</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">pathXYZ</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Load a previously captured image from a specific path &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pathXYZ</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;.pcf&#39;</span><span class="p">:</span>
            <span class="n">tempIdxImage</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">pathXYZ</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;.pf&#39;</span><span class="p">:</span>
            <span class="n">tempIdxImage</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Could not load image, wrong extension</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iLoadImage</span><span class="p">(</span><span class="n">tempIdxImage</span><span class="p">,</span> <span class="n">pathXYZ</span><span class="p">)</span> <span class="c1"># add folder ??</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image </span><span class="si">{:s}</span><span class="s1"> loaded in imageIdx=</span><span class="si">{:0.0f}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pathXYZ</span><span class="p">,</span><span class="n">tempIdxImage</span><span class="p">))</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span> <span class="o">=</span> <span class="n">tempIdxImage</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iLoadImage: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>



<div class="viewcode-block" id="lmkActiveX.getStatistic">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.getStatistic">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getStatistic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">statisticType</span><span class="p">,</span><span class="n">regionName</span><span class="p">,</span><span class="n">colorSpace</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get Cmin, Cmax, Cmean, Cvar for specified colorSpace for a specific region &quot;&quot;&quot;</span>
        <span class="n">tmpA</span><span class="p">,</span> <span class="n">tmpB</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iCreateStatistic</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">),</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;1&#39;</span><span class="p">])</span>
        <span class="n">tmpA</span><span class="p">,</span> <span class="n">tmpB</span><span class="p">,</span> <span class="n">tmpC</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetStatisticselfect</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">))</span>
            
        <span class="c1"># Get the statistic (always in RGB values):</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">RirSize</span><span class="p">,</span> <span class="n">RdrMin</span><span class="p">,</span> <span class="n">RdrMax</span><span class="p">,</span> <span class="n">RdrMean</span><span class="p">,</span> <span class="n">RdrVar</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetStandardStatistic2</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">GirSize</span><span class="p">,</span> <span class="n">GdrMin</span><span class="p">,</span> <span class="n">GdrMax</span><span class="p">,</span> <span class="n">GdrMean</span><span class="p">,</span> <span class="n">GdrVar</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetStandardStatistic2</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">BirSize</span><span class="p">,</span> <span class="n">BdrMin</span><span class="p">,</span> <span class="n">BdrMax</span><span class="p">,</span> <span class="n">BdrMean</span><span class="p">,</span> <span class="n">BdrVar</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetStandardStatistic2</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># pause</span>
        
        <span class="c1"># Convert these values to the given colorspace:</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">CminX</span><span class="p">,</span> <span class="n">CminY</span><span class="p">,</span> <span class="n">CminZ</span>     <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetColor</span><span class="p">(</span><span class="n">RdrMin</span><span class="p">,</span><span class="n">GdrMin</span><span class="p">,</span> <span class="n">BdrMin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colorSpace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">CmaxX</span><span class="p">,</span> <span class="n">CmaxY</span><span class="p">,</span> <span class="n">CmaxZ</span>     <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetColor</span><span class="p">(</span><span class="n">RdrMax</span><span class="p">,</span> <span class="n">GdrMax</span><span class="p">,</span> <span class="n">BdrMax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colorSpace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">CmeanX</span><span class="p">,</span> <span class="n">CmeanY</span><span class="p">,</span> <span class="n">CmeanZ</span>  <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetColor</span><span class="p">(</span><span class="n">RdrMean</span><span class="p">,</span> <span class="n">GdrMean</span><span class="p">,</span> <span class="n">BdrMean</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colorSpace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">tmp</span><span class="p">,</span> <span class="n">CvarX</span><span class="p">,</span> <span class="n">CvarY</span><span class="p">,</span> <span class="n">CvarZ</span>     <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetColor</span><span class="p">(</span><span class="n">RdrVar</span><span class="p">,</span> <span class="n">GdrVar</span><span class="p">,</span> <span class="n">BdrVar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colorSpace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">Cmin</span> <span class="o">=</span> <span class="p">[</span><span class="n">CminX</span><span class="p">,</span> <span class="n">CminY</span><span class="p">,</span> <span class="n">CminZ</span><span class="p">]</span>
        <span class="n">Cmax</span> <span class="o">=</span> <span class="p">[</span><span class="n">CmaxX</span><span class="p">,</span> <span class="n">CmaxY</span><span class="p">,</span> <span class="n">CmaxZ</span><span class="p">]</span>
        <span class="n">Cmean</span> <span class="o">=</span> <span class="p">[</span><span class="n">CmeanX</span><span class="p">,</span> <span class="n">CmeanY</span><span class="p">,</span> <span class="n">CmeanZ</span><span class="p">]</span>
        <span class="n">Cvar</span> <span class="o">=</span> <span class="p">[</span><span class="n">CvarX</span><span class="p">,</span> <span class="n">CvarY</span><span class="p">,</span> <span class="n">CvarZ</span><span class="p">]</span>
        
        <span class="c1">#delete the statistic object:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iDeleteStatistic</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span>  <span class="n">Cmin</span><span class="p">,</span> <span class="n">Cmax</span><span class="p">,</span> <span class="n">Cmean</span><span class="p">,</span> <span class="n">Cvar</span></div>

        
<div class="viewcode-block" id="lmkActiveX.get_color_autoscan_times">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_color_autoscan_times">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">get_color_autoscan_times</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">autoscantimes</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iColorAutoScanTime</span><span class="p">([</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">filter_wheel_names</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iColorAutoScanTime: ColorAutoScanTimes </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">autoscantimes</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iColorAutoScanTime: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">autoscantimes</span></div>


        
<div class="viewcode-block" id="lmkActiveX.capture_X_map">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.capture_X_map">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">capture_X_map</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">X_type</span> <span class="o">=</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">,</span> 
                             <span class="n">startRatio</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                             <span class="n">countPic</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">modfrequency</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Measure XYZ / Y image and save as .pcf / .pf image. </span>
<span class="sd">        (parameters as set in class attributes) </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">startRatio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">startRatio</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">captureStartRatio</span>
        <span class="k">if</span> <span class="n">factor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">factor</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">captureFactor</span>
        <span class="k">if</span> <span class="n">countPic</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">countPic</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">captureCountPic</span>
        <span class="k">if</span> <span class="n">defaultMaxTries</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">captureDefaultMaxTries</span>
        <span class="n">currTries</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_autoscan</span><span class="p">(</span><span class="n">autoscan</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_autoexposure</span><span class="p">(</span><span class="n">autoexposure</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_mod_frequency</span><span class="p">(</span><span class="n">modfrequency</span><span class="p">)</span> 
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_max_exposure_time</span><span class="p">(</span><span class="n">maxtime</span><span class="p">)</span>
        
        <span class="c1"># setWeorkingImage:</span>
        <span class="k">if</span> <span class="n">X_type</span> <span class="o">==</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">setWorkingImage</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">imageType</span><span class="p">[</span><span class="s1">&#39;Color&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">X_type</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">setWorkingImage</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">imageType</span><span class="p">[</span><span class="s1">&#39;Luminance&#39;</span><span class="p">])</span>
        
        <span class="c1"># Capture image:</span>
        <span class="n">tempFlag</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">currTries</span> <span class="o">&lt;=</span> <span class="n">defaultMaxTries</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tempFlag</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting capturing </span><span class="si">{}</span><span class="s1">-image: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_type</span><span class="p">,</span><span class="n">fileName</span><span class="p">))</span>
    
            <span class="k">if</span> <span class="n">X_type</span> <span class="o">==</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">:</span>
                <span class="n">tempFlag</span><span class="p">,</span> <span class="n">capture_XImg</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iColorCaptureHighDyn</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">startRatio</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">countPic</span><span class="p">)</span>
                <span class="n">fcn_name</span> <span class="o">=</span> <span class="s1">&#39;iColorCaptureHighDyn&#39;</span>
            <span class="k">elif</span> <span class="n">X_type</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
                <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iHighDynPic3</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">startRatio</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">countPic</span><span class="p">)</span> <span class="c1"># first arg was 0 ??</span>
                <span class="n">capture_XImg</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># iHighDynPic3 doesn&#39;t output image, but iColorCaptureHighDyn does ?</span>
                <span class="n">fcn_name</span> <span class="o">=</span> <span class="s1">&#39;iHighDynPic3&#39;</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Don&#39;t know what to capture as X_type = </span><span class="si">{:s}</span><span class="s2"> is unknown (options &#39;XYZ&#39;, &#39;Y&#39;)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_type</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:s}</span><span class="s1">: image captured</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fcn_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">currTries</span> <span class="o">=</span> <span class="n">currTries</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error </span><span class="si">{:s}</span><span class="s1">: Try </span><span class="si">{:1.0f}</span><span class="s1">/</span><span class="si">{:1.0f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fcn_name</span><span class="p">,</span><span class="n">currTries</span><span class="p">,</span><span class="n">defaultMaxTries</span><span class="p">))</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
                
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Capture </span><span class="si">{}</span><span class="s1">-image failed:</span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_type</span><span class="p">,</span><span class="n">fileName</span><span class="p">))</span>
        
        <span class="c1"># Save image:</span>
        <span class="k">if</span> <span class="n">X_type</span> <span class="o">==</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">:</span> 
            <span class="n">imgPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.pcf&#39;</span><span class="p">)</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSaveImage</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">imgPath</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">X_type</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
            <span class="n">imgPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">+</span> <span class="s1">&#39;.pf&#39;</span><span class="p">)</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSaveImage</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">imgPath</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSaveImage: image saved: </span><span class="si">{:s}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imgPath</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSaveImage: error saving </span><span class="si">{:s}</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imgPath</span><span class="p">))</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

            
<div class="viewcode-block" id="lmkActiveX.captureXYZmap">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.captureXYZmap">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">captureXYZmap</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">folderXYZ</span><span class="p">,</span> <span class="n">fileNameXYZ</span><span class="p">,</span>
                    <span class="n">startRatio</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="n">countPic</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">modfrequency</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Measure XYZ image and save as .pcf image. (parameters as set in class attributes) &quot;&quot;&quot;</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">capture_X_map</span><span class="p">(</span><span class="n">folderXYZ</span><span class="p">,</span> <span class="n">fileNameXYZ</span><span class="p">,</span> <span class="n">X_type</span> <span class="o">=</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">,</span>
                                 <span class="n">startRatio</span> <span class="o">=</span> <span class="n">startRatio</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span><span class="p">,</span> 
                                 <span class="n">countPic</span> <span class="o">=</span> <span class="n">countPic</span><span class="p">,</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="n">defaultMaxTries</span><span class="p">,</span>
                                 <span class="n">autoscan</span> <span class="o">=</span> <span class="n">autoscan</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="n">autoexposure</span><span class="p">,</span>
                                 <span class="n">modfrequency</span> <span class="o">=</span> <span class="n">modfrequency</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="n">maxtime</span><span class="p">)</span>  </div>


<div class="viewcode-block" id="lmkActiveX.captureYmap">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.captureYmap">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">captureYmap</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">folderY</span><span class="p">,</span> <span class="n">fileNameY</span><span class="p">,</span>
                    <span class="n">startRatio</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                    <span class="n">countPic</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">modfrequency</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Measure Y image and save as .pf image. (parameters as set in class attributes) &quot;&quot;&quot;</span>
    
        <span class="bp">cls</span><span class="o">.</span><span class="n">capture_X_map</span><span class="p">(</span><span class="n">folderY</span><span class="p">,</span> <span class="n">fileNameY</span><span class="p">,</span> <span class="n">X_type</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span>
                                 <span class="n">startRatio</span> <span class="o">=</span> <span class="n">startRatio</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span><span class="p">,</span> 
                                 <span class="n">countPic</span> <span class="o">=</span> <span class="n">countPic</span><span class="p">,</span> <span class="n">defaultMaxTries</span> <span class="o">=</span> <span class="n">defaultMaxTries</span><span class="p">,</span>
                                 <span class="n">autoscan</span> <span class="o">=</span> <span class="n">autoscan</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="n">autoexposure</span><span class="p">,</span>
                                 <span class="n">modfrequency</span> <span class="o">=</span> <span class="n">modfrequency</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="n">maxtime</span><span class="p">)</span></div>

        

<div class="viewcode-block" id="lmkActiveX.createEllips">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.createEllips">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">createEllips</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">centerPt</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">regionName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Create an ellips with a:</span>
<span class="sd">        | - centerPoint defined by centerPt (contains x and y value)</span>
<span class="sd">        | - certain width (horizontal axis)</span>
<span class="sd">        | - certain height (vertical axis)</span>
<span class="sd">        | - give the ellips region a regionName (string)</span>

<span class="sd">        Function returns the regionIndex of the ellips</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">listXpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">centerPt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centerPt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">centerPt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">width</span><span class="p">)]]</span>
        <span class="n">listYpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">centerPt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">centerPt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">height</span><span class="p">),</span> <span class="n">centerPt</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        
        <span class="n">int32</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="c1"># check if iCreateRegion really does require int32 values as input (for now: pass python int)</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">errorFlag</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iCreateRegion</span><span class="p">(</span><span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">),</span>
                                                  <span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">regionType</span><span class="p">[</span><span class="s1">&#39;Ellipse&#39;</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]),</span>
                                                  <span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">regionType</span><span class="p">[</span><span class="s1">&#39;Ellipse&#39;</span><span class="p">][</span><span class="s1">&#39;points&#39;</span><span class="p">]),</span>
                                                  <span class="n">listXpts</span><span class="p">,</span>
                                                  <span class="n">listYpts</span><span class="p">)</span>
            
        <span class="c1"># Gets the number of regions defined in the workingImage:</span>
        <span class="n">_</span><span class="p">,</span><span class="n">numberOfRegions</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetRegionListSize</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            
        <span class="c1"># Set the last region to the specified regionName:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetRegionName</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">numberOfRegions</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">regionName</span><span class="p">)</span>
        <span class="n">regionIndex</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regionIndex</span></div>

        
        
<div class="viewcode-block" id="lmkActiveX.createPolygon">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.createPolygon">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">createPolygon</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pointsXY</span><span class="p">,</span> <span class="n">regionName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Create a polygon with:</span>
<span class="sd">        | - vertices specified in pointsXY (x-&gt;width, y-&gt;height)</span>
<span class="sd">        | - give the polygon region a regionName (string)</span>

<span class="sd">        Function returns the regionIndex of the polygon</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">listXpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pointsXY</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">listYpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pointsXY</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        
        <span class="n">int32</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="c1"># check if iCreateRegion really does require int32 values as input (for now: pass python int)</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">errorFlag</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iCreateRegion</span><span class="p">(</span>
                                                 <span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">),</span>
                                                 <span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">regionType</span><span class="p">[</span><span class="s1">&#39;Polygon&#39;</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]),</span>
                                                 <span class="n">int32</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">listXpts</span><span class="p">))),</span>
                                                 <span class="n">listXpts</span><span class="p">,</span>
                                                 <span class="n">listYpts</span>
                                                 <span class="p">)</span>
            
        <span class="c1"># Gets the number of regions defined in the workingImage:</span>
        <span class="n">_</span><span class="p">,</span><span class="n">numberOfRegions</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetRegionListSize</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            
        <span class="c1"># Set the last region to the specified regionName:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetRegionName</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">numberOfRegions</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">regionName</span><span class="p">)</span>
        <span class="n">regionIndex</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regionIndex</span></div>

    
<div class="viewcode-block" id="lmkActiveX.createRectangle">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.createRectangle">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">createRectangle</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topleftXY</span><span class="p">,</span> <span class="n">bottomrightXY</span><span class="p">,</span> <span class="n">regionName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Create a Rectangle spanning:</span>
<span class="sd">        | - the top-left and bottom-right vertices </span>
<span class="sd">        | - give the rectangle region a regionName (string)</span>
<span class="sd">        </span>
<span class="sd">        Function returns the regionIndex of the rectangle</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">listXpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">topleftXY</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bottomrightXY</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>
        <span class="n">listYpts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">topleftXY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bottomrightXY</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        
        <span class="n">int32</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="c1"># check if iCreateRegion really does require int32 values as input (for now: pass python int)</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">errorFlag</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iCreateRegion</span><span class="p">(</span>
                                                 <span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">),</span>
                                                 <span class="n">int32</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">regionType</span><span class="p">[</span><span class="s1">&#39;Polygon&#39;</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]),</span>
                                                 <span class="n">int32</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">listXpts</span><span class="p">))),</span>
                                                 <span class="n">listXpts</span><span class="p">,</span>
                                                 <span class="n">listYpts</span>
                                                 <span class="p">)</span>
            
        <span class="c1"># Gets the number of regions defined in the workingImage:</span>
        <span class="n">_</span><span class="p">,</span><span class="n">numberOfRegions</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetRegionListSize</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            
        <span class="c1"># Set the last region to the specified regionName:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetRegionName</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">numberOfRegions</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">regionName</span><span class="p">)</span>
        <span class="n">regionIndex</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regionIndex</span></div>

        
<div class="viewcode-block" id="lmkActiveX.deleteRegionByName">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.deleteRegionByName">[docs]</a>
    <span class="nd">@classmethod</span>   
    <span class="k">def</span><span class="w"> </span><span class="nf">deleteRegionByName</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">regionName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Delete a Region by regioName &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">errorFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iDeleteRegion</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">));</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">checkForError</span><span class="p">()</span></div>

        
        
<div class="viewcode-block" id="lmkActiveX.getRegionIndexByName">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.getRegionIndexByName">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getRegionIndexByName</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">regionName</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Return the index of a region with a region name set to regionName. &quot;&quot;&quot;</span>
        <span class="n">regionIndex</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="bp">cls</span><span class="o">.</span><span class="n">errorFlag</span><span class="p">,</span> <span class="n">regionIndex</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetIndexOfRegion</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span> <span class="n">regionName</span><span class="p">,</span> <span class="n">regionIndex</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">checkForError</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">regionIndex</span></div>


<div class="viewcode-block" id="lmkActiveX.createStatisticObjectOfRegion">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.createStatisticObjectOfRegion">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">createStatisticObjectOfRegion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">regionName</span><span class="p">,</span> <span class="n">statisticType</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Create a color statistic object</span>
<span class="sd">        | call as follows: createStatisticObjectOfRegion(&#39;regionTestName&#39;,statisticType[&#39;standardColor&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iCreateStatistic</span><span class="p">(</span><span class="n">statisticType</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">),</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;1&#39;</span><span class="p">])</span></div>

        
        
<div class="viewcode-block" id="lmkActiveX.selectRegionByIndex">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.selectRegionByIndex">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">selectRegionByIndex</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">ind</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select a region by its index number s defines wether the region is selected or deselected (true or false)        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSelectRegion</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span><span class="n">ind</span><span class="p">,</span><span class="n">s</span><span class="p">)</span></div>


        
<div class="viewcode-block" id="lmkActiveX.selectRegionByName">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.selectRegionByName">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">selectRegionByName</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">regionName</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Select a region by its region name, s defines wether the region is selected or deselected (true or false)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSelectRegion</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">workingImage</span><span class="p">,</span><span class="bp">cls</span><span class="o">.</span><span class="n">getRegionIndexByName</span><span class="p">(</span><span class="n">regionName</span><span class="p">),</span><span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="lmkActiveX.setIntegrationTime">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.setIntegrationTime">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setIntegrationTime</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">wishedTime</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set integration time.</span>
<span class="sd">        |  [int32, double] LMKAxServer::iSetIntegrationTime	(double _dWishedTime, double &amp; _drRealizedTime)</span>

<span class="sd">        Parameters:</span>
<span class="sd">            :_dWishedTime: Wished integration time</span>
<span class="sd">         	:_drRealizedTime: Realized integration time</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">realizedTime</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetIntegrationTime</span><span class="p">(</span><span class="n">wishedTime</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetIntegrationTime: </span><span class="se">\t</span><span class="si">{:1.2f}</span><span class="s1">[s]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">realizedTime</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetIntegrationTime: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

    
<div class="viewcode-block" id="lmkActiveX.getIntegrationTime">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.getIntegrationTime">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getIntegrationTime</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get integration time.</span>
<span class="sd">        |  [int32, double, double, double, double, double]	LMKAxServer::iGetIntegrationTime</span>
<span class="sd">        | 	(handle, double _drCurrentTime, double &amp; _drPreviousTime,</span>
<span class="sd">        |		double &amp; _drNextTime, double &amp; _drMinTime, double &amp; _drMaxTime )</span>
<span class="sd">        |</span>
<span class="sd">        |  Determine current exposure time and other time parameters.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">         	:_drCurrentTime: Current integration time</span>
<span class="sd">         	:_drPreviousTime: Next smaller (proposed) time</span>
<span class="sd">         	:_drNextTime: Next larger (proposed) time</span>
<span class="sd">         	:_drMinTime: Minimal possible time</span>
<span class="sd">         	:_drMaxTime: Maximal possible time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">currInt</span><span class="p">,</span> <span class="n">prevInt</span><span class="p">,</span> <span class="n">nextInt</span><span class="p">,</span> <span class="n">minInt</span><span class="p">,</span> <span class="n">maxInt</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetIntegrationTime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetIntegrationTime: currInt=</span><span class="si">{:1.3f}</span><span class="s1">[s] prevInt=</span><span class="si">{:1.3f}</span><span class="s1">[s] nextInt=</span><span class="si">{:1.3f}</span><span class="s1">[s] minInt=</span><span class="si">{:1.3f}</span><span class="s1">[s] maxInt=</span><span class="si">{:1.3f}</span><span class="s1">[s] </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currInt</span><span class="p">,</span> <span class="n">prevInt</span><span class="p">,</span> <span class="n">nextInt</span><span class="p">,</span> <span class="n">minInt</span><span class="p">,</span> <span class="n">maxInt</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iGetIntegrationTime: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">currInt</span><span class="p">,</span> <span class="n">prevInt</span><span class="p">,</span> <span class="n">nextInt</span><span class="p">,</span> <span class="n">minInt</span><span class="p">,</span> <span class="n">maxInt</span></div>

     
<div class="viewcode-block" id="lmkActiveX.set_autoscan">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_autoscan">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_autoscan</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Set auto scan. </span>
<span class="sd">        </span>
<span class="sd">        If the option Autoscan is on, then the exposure time of the camera is automatically</span>
<span class="sd">        determined before each capture by the autoscan algorithm. In the case of a</span>
<span class="sd">        color capture the autoscan algorithm is applied to each color filter separately.</span>
<span class="sd">        &quot;&quot;&quot;</span> 

        <span class="k">if</span> <span class="n">autoscan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">autoscan</span> <span class="o">=</span> <span class="n">autoscan</span>
        <span class="c1"># if cls.autoscan == 1:</span>
        <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetAutoscan</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">autoscan</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetAutoscan: AutoScan </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">boolStr</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">autoscan</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetAutoscan: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

            
<div class="viewcode-block" id="lmkActiveX.get_autoscan">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_autoscan">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_autoscan</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get auto scan. </span>
<span class="sd">        &quot;&quot;&quot;</span> 

        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">autoscan</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetAutoscan</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetAutoscan: AutoScan </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">boolStr</span><span class="p">[</span><span class="n">autoscan</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iGetAutoscan: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">autoscan</span></div>

    
<div class="viewcode-block" id="lmkActiveX.set_autoexposure">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_autoexposure">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_autoexposure</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Set Automatic-Flag for all exposure times. </span>
<span class="sd">        </span>
<span class="sd">        If this flag is set, all exposure times will automatically </span>
<span class="sd">        adjusted if camera exposure time is reduced or enlarged.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">autoexposure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">autoexposure</span> <span class="o">=</span> <span class="n">autoexposure</span>
        <span class="c1"># if cls.autoexposure == 1:</span>
        <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetAutomatic</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="bp">cls</span><span class="o">.</span><span class="n">autoexposure</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetAutomatic: iSetAutomatic </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">boolStr</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">autoexposure</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetAutomatic: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

    
<div class="viewcode-block" id="lmkActiveX.get_autoexposure">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_autoexposure">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_autoexposure</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get Automatic-Flag for all exposure times.</span>
<span class="sd">        &quot;&quot;&quot;</span> 
        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetAutomatic</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetAutomatic: AutoExposure </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">boolStr</span><span class="p">[</span><span class="n">autoexposure</span><span class="p">]))</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iGetAutomatic: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">autoexposure</span></div>

    
<div class="viewcode-block" id="lmkActiveX.set_focusfactor">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_focusfactor">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_focusfactor</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">focusfactor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set focus factor of lens &quot;&quot;&quot;</span>
        <span class="c1"># List of available focus factors.</span>
        <span class="c1"># [int32, SafeArray Pointer(string), int32]</span>
        <span class="c1">#   iGetFocusFactorList	(handle, SafeArray Pointer(string), int32)</span>
        <span class="c1">#</span>
        <span class="c1">#   listFocusFactors	List of factors</span>
        <span class="c1">#   selectedIdxFocus	Index of currently used factor, indexes begin with &quot;0&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">listFocusFactors</span><span class="p">,</span> <span class="n">selectedIdxFocus</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetFocusFactorList</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">focusfactor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">focusfactor</span> <span class="o">=</span> <span class="n">focusfactor</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">focusfactor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Set a focus factor</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetFocusFactor</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">focusfactor</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">tempFocusFactorList</span><span class="p">,</span> <span class="n">tempCurrIdx</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetFocusFactorList</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetFocusFactor: </span><span class="se">\t</span><span class="si">{:s}</span><span class="s1"> (Idx=</span><span class="si">{:.0f}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tempFocusFactorList</span><span class="p">[</span><span class="n">tempCurrIdx</span><span class="p">],</span><span class="n">tempCurrIdx</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetFocusFactor: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>


<div class="viewcode-block" id="lmkActiveX.get_focusfactor">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_focusfactor">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_focusfactor</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get focus factor of lens &quot;&quot;&quot;</span>
        <span class="c1"># Get a focus factor</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">FocusFactorList</span><span class="p">,</span> <span class="n">CurrIdx</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetFocusFactorList</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetFocusFactor: </span><span class="se">\t</span><span class="si">{:s}</span><span class="s1"> (Idx=</span><span class="si">{:.0f}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">FocusFactorList</span><span class="p">[</span><span class="n">CurrIdx</span><span class="p">],</span><span class="n">CurrIdx</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">FocusFactorList</span><span class="p">[</span><span class="n">CurrIdx</span><span class="p">],</span> <span class="n">CurrIdx</span></div>


<div class="viewcode-block" id="lmkActiveX.set_max_exposure_time">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_max_exposure_time">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">set_max_exposure_time</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Set the maximum possible exposure time.</span>
<span class="sd">        |  int LMKAxServer::iSetMaxCameraTime	(	double 	_dMaxCameraTime	)</span>
<span class="sd">        | </span>
<span class="sd">        |  The maximum values is of course restricted by camera properties.</span>
<span class="sd">        |  But you can use an even smaller time to avoid to long meausrement times.</span>
<span class="sd">         </span>
<span class="sd">        Parameters:</span>
<span class="sd">            :_dMaxCameraTime: Wished value</span>
<span class="sd">            :maxCameraTime:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">maxtime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">maxtime</span> <span class="o">=</span> <span class="n">maxtime</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">maxtime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetMaxCameraTime</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">maxtime</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tempFlag</span><span class="p">,</span> <span class="n">maxIntT</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetMaxCameraTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetMaxCameraTime: </span><span class="se">\t</span><span class="si">{:.0f}</span><span class="s1">[s]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxIntT</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetMaxCameraTime: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>


<div class="viewcode-block" id="lmkActiveX.get_max_exposure_time">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_max_exposure_time">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">get_max_exposure_time</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get the maximum possible exposure time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">maxIntT</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetMaxCameraTime</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetMaxCameraTime: </span><span class="se">\t</span><span class="si">{:.0f}</span><span class="s1">[s]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxIntT</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iGetMaxCameraTime: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">maxIntT</span></div>


<div class="viewcode-block" id="lmkActiveX.set_mod_frequency">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_mod_frequency">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">set_mod_frequency</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">modfrequency</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Set the frequency of modulated light.</span>
<span class="sd">        |  int LMKAxServer::iSetModulationFrequency	(	double 	_dModFrequency	)</span>
<span class="sd">        |</span>
<span class="sd">        |  If the light source is driven by alternating current,</span>
<span class="sd">        |  there are some restriction for the exposure times.</span>
<span class="sd">        |  Please inform the program about the modulation frequency.</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">            :_dModFrequency:	Frequency of light source. 0 if no modulation is to be concerend</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">modfrequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">modfrequency</span> <span class="o">=</span> <span class="n">modfrequency</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">modfrequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">modfrequency</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()):</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetModulationFrequency</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">modfrequency</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tempFlag</span><span class="p">,</span> <span class="n">modFrequencyMeas</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetModulationFrequency</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetModulationFrequency: </span><span class="se">\t</span><span class="si">{:.0f}</span><span class="s1">[Hz]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">modFrequencyMeas</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetModulationFrequency: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>

                
<div class="viewcode-block" id="lmkActiveX.get_mod_frequency">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_mod_frequency">[docs]</a>
    <span class="nd">@classmethod</span> 
    <span class="k">def</span><span class="w"> </span><span class="nf">get_mod_frequency</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get the frequency setting of modulated light.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">modFrequencyMeas</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetModulationFrequency</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetModulationFrequency: </span><span class="se">\t</span><span class="si">{:.0f}</span><span class="s1">[Hz]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">modFrequencyMeas</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iGetModulationFrequency: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">modFrequencyMeas</span></div>

                
<div class="viewcode-block" id="lmkActiveX.init">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.init">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;    init lmk ActiveX &quot;&quot;&quot;</span>
         
 
        <span class="c1"># open a connection, if not already open:</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span> <span class="c1"># already open connection</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">open_lmk_labsoft_connection</span><span class="p">(</span><span class="n">objectiveCalibrationPath</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objectiveCalibrationPath</span><span class="p">)</span>
        
        <span class="c1"># Set new camera calibration data &amp; lens</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">camera</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">lens</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># use no camera</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetNewCamera2</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetNewCamera2</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">camera</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span><span class="bp">cls</span><span class="o">.</span><span class="n">lens</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>

        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetNewCamera2 ok!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetNewCamera2: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        
        <span class="c1"># Returns path to current camera lens combination.</span>
        <span class="n">_</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">cameraLensPath</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetCameraLensPath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetCameraLensPath: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">cameraLensPath</span><span class="p">))</span>
        
        <span class="c1"># Set max. number of filter wheels and their names:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">filter_wheel_max</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">filter_wheel_names</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_filter_wheel_info</span><span class="p">()</span>
        
        <span class="c1"># Set parameters capturing method</span>
        <span class="c1"># Set auto scan</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_autoscan</span><span class="p">(</span><span class="n">autoscan</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">autoscan</span><span class="p">)</span>
        
        <span class="c1"># Set Automatic-Flag for all exposure times. </span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_autoexposure</span><span class="p">(</span><span class="n">autoexposure</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">autoexposure</span><span class="p">)</span>
        
        <span class="c1"># Set lens focus factor.</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_focusfactor</span><span class="p">(</span><span class="n">focusfactor</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">focusfactor</span><span class="p">)</span>        
        
        <span class="c1"># Set the maximum possible exposure time.</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_max_exposure_time</span><span class="p">(</span><span class="n">maxtime</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">maxtime</span><span class="p">)</span>        
        
        <span class="c1"># Set the frequency of modulated light.</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_mod_frequency</span><span class="p">(</span><span class="n">modfrequency</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">modfrequency</span><span class="p">)</span> 
        
        <span class="c1"># Set units to cd/m :</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">set_converting_units</span><span class="p">()</span></div>

       
<div class="viewcode-block" id="lmkActiveX.set_converting_units">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_converting_units">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_converting_units</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">units_name</span> <span class="o">=</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;cd/m&quot;</span><span class="p">,</span> <span class="n">units_factor</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the converting units (units_name, units, units_factor)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">units_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units_name</span> <span class="o">=</span> <span class="n">units_name</span> 
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span> 
        <span class="k">if</span> <span class="n">units_factor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units_factor</span> <span class="o">=</span> <span class="n">units_factor</span>
        <span class="n">tempFlag</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iSetConvertingUnits</span><span class="p">(</span><span class="n">units_name</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">units_factor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iSetConvertingUnits: </span><span class="se">\t</span><span class="s1">units_name: </span><span class="si">{}</span><span class="s1">; units: </span><span class="si">{}</span><span class="s1">; units_factor: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">units_name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units_factor</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetConvertingUnits: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>


<div class="viewcode-block" id="lmkActiveX.get_converting_units">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.get_converting_units">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_converting_units</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Get the converting units (units_name, units, units_factor)&quot;&quot;&quot;</span>
        <span class="n">tempFlag</span><span class="p">,</span> <span class="n">units_name</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">units_factor</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetConvertingUnits</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">units_name</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">units_factor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tempFlag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;iGetConvertingUnits: </span><span class="se">\t</span><span class="s1">units_name: </span><span class="si">{}</span><span class="s1">; units: </span><span class="si">{}</span><span class="s1">; units_factor: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units_name</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">units_factor</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error iSetConvertingUnits: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">units_name</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">units_factor</span></div>

     
       
<div class="viewcode-block" id="lmkActiveX.set_verbosity">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.set_verbosity">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_verbosity</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity_levels</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="n">value</span></div>

    
<div class="viewcode-block" id="lmkActiveX.checkForError">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.lmkActiveX.checkForError">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">checkForError</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">global</span> <span class="n">ST</span>
        <span class="n">ST</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">extract_stack</span><span class="p">(</span><span class="n">limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># matlab: ST = dbstack(&#39;-completenames&#39;,1)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">errorFlag</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span> <span class="n">errorInfo</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lmk</span><span class="o">.</span><span class="n">iGetErrorInformation</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Error: </span><span class="si">{}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> info: </span><span class="si">{:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span><span class="n">errorInfo</span><span class="p">))</span></div>
</div>

   
<span class="c1">#==============================================================================</span>
<span class="c1"># Working with PCF images</span>
<span class="c1">#==============================================================================   </span>
<div class="viewcode-block" id="read_pcf">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.read_pcf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">read_pcf</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Read a TechnoTeam PCF image. (!!! output = float32 CIE-RGB !!!)&quot;&quot;&quot;</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;latin_1&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span> 
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">:</span> 
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
                <span class="n">img_type</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span> 
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
            
        <span class="n">totalNumberOfBytes</span> <span class="o">=</span> <span class="n">rows</span><span class="o">*</span><span class="n">cols</span><span class="o">*</span><span class="mi">12</span> <span class="c1"># Twelve bytes per pixel. </span>
        <span class="c1"># 3 &quot;Float&quot; values each for the three colors. The chromaticity </span>
        <span class="c1"># values in the file are in the order of blue - green - read.</span>
        
        <span class="n">pixeldata</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="n">img_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">pixeldata</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">img_raw</span><span class="p">[</span><span class="o">...</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># BGR to RGB</span></div>


<div class="viewcode-block" id="write_pcf">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.write_pcf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">write_pcf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Write a basic TechnoTeam PCF image. (!!! output = float32 CIE-RGB !!!)&quot;&quot;&quot;</span>
    <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;latin_1&#39;</span>
    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">byteObj</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Typ=Pic98::TPlane&lt;Pic98::TRGBFloatPixel&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Lines=</span><span class="si">{:1.0f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Columns=</span><span class="si">{:1.0f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">byteObj</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<div class="viewcode-block" id="ciergb_to_xyz">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.ciergb_to_xyz">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ciergb_to_xyz</span><span class="p">(</span><span class="n">rgb</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert CIE-RGB to XYZ &quot;&quot;&quot;</span>
    <span class="c1"># matrix from TechnoTeam&#39;s LMK4.pdf (p311, February 27, 2017 version)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.7689</span><span class="p">,</span><span class="mf">1.7518</span><span class="p">,</span><span class="mf">1.1302</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span><span class="mf">4.5907</span><span class="p">,</span><span class="mf">0.0601</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span><span class="mf">0.0565</span><span class="p">,</span><span class="mf">5.5943</span><span class="p">]])</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">rgb</span> <span class="o">@</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></div>


<div class="viewcode-block" id="xyz_to_ciergb">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.xyz_to_ciergb">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">xyz_to_ciergb</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert XYZ to CIE-RGB &quot;&quot;&quot;</span>
    <span class="c1"># matrix from TechnoTeam&#39;s LMK4.pdf (p311, February 27, 2017 version)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.4185</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1587</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0828</span><span class="p">],</span>
                  <span class="p">[</span><span class="o">-</span><span class="mf">0.0912</span><span class="p">,</span><span class="mf">0.2524</span><span class="p">,</span><span class="mf">0.0157</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.0009</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0026</span><span class="p">,</span><span class="mf">0.1786</span><span class="p">]])</span>  
    <span class="k">return</span> <span class="p">(</span><span class="n">xyz</span> <span class="o">@</span> <span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></div>



<div class="viewcode-block" id="pcf_to_xyz">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.pcf_to_xyz">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">pcf_to_xyz</span><span class="p">(</span><span class="n">pcf_image</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert a TechnoTeam PCF image to XYZ &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ciergb_to_xyz</span><span class="p">(</span><span class="n">pcf_image</span><span class="p">)</span></div>


<div class="viewcode-block" id="xyz_to_pcf">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.xyz_to_pcf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">xyz_to_pcf</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert an xyz image to a TechnoTeam PCF &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">xyz_to_ciergb</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span></div>


<span class="k">def</span><span class="w"> </span><span class="nf">img_to_01</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Normalize image to 0 - 1 range &quot;&quot;&quot;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="p">(</span><span class="n">img</span> <span class="o">-</span> <span class="n">img</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">img</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">img</span>

<div class="viewcode-block" id="plot_pcf">
<a class="viewcode-back" href="../../../../toolboxes.html#luxpy.toolboxes.technoteamlmk.plot_pcf">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_pcf</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">to_01_range</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot a TechnoTeam PCF image. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">read_pcf</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">to_01_range</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">img_to_01</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="c1"># min -&gt; 0, max -&gt; 1 for imshow (avoid clipping)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">norm_str</span> <span class="o">=</span> <span class="s1">&#39;(normalized to 0-1 range)&#39;</span> <span class="k">if</span> <span class="n">to_01_range</span>  <span class="k">else</span> <span class="s1">&#39;(not normalized)&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCF image </span><span class="si">{:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">norm_str</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">img</span></div>

        
   
    
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1">#========================================================</span>
    <span class="c1"># TEST CODE</span>
    <span class="c1">#========================================================</span>
    <span class="n">folder_name</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;./&#39;</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--0-- Test lmkActiveX init&#39;</span><span class="p">)</span>      
    <span class="c1"># Create an lmkX object:</span>
    <span class="n">lmkX</span> <span class="o">=</span> <span class="n">lmkActiveX</span><span class="p">(</span><span class="s1">&#39;tts20035&#39;</span><span class="p">,</span> <span class="s1">&#39;xvr&#39;</span><span class="p">,</span> <span class="n">focusfactor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">autoexposure</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="n">modfrequency</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">maxtime</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                      <span class="n">verbosity</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--1-- Test measure multiple XYZ images&#39;</span><span class="p">)</span>
    <span class="c1"># Make multiple measurement and save:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">lmkX</span><span class="o">.</span><span class="n">captureXYZmap</span><span class="p">(</span><span class="n">folder_name</span><span class="p">,</span> <span class="s1">&#39;testXYZ_</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--2-- Test measure Y image&#39;</span><span class="p">)</span>
    <span class="n">lmkX</span><span class="o">.</span><span class="n">captureYmap</span><span class="p">(</span><span class="n">folder_name</span><span class="p">,</span> <span class="s1">&#39;testY_</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--3-- Test measure of ColorMultipic&#39;</span><span class="p">)</span>
    <span class="c1"># Capture ColorMultipic image</span>
    <span class="n">lmkX</span><span class="o">.</span><span class="n">measureColorMultipic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--4a-- Test creation of elliptical region&#39;</span><span class="p">)</span>
    <span class="c1"># Create an elliptical region</span>
    <span class="n">lmkX</span><span class="o">.</span><span class="n">createEllips</span><span class="p">([</span><span class="mi">3018</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4103</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span><span class="mi">300</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;ellipse_test&#39;</span><span class="p">)</span> 
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--4b-- Test creation of rectangular region and selecting it&#39;</span><span class="p">)</span>
    <span class="c1"># Create an rectangle region and select it:</span>
    <span class="n">lmkX</span><span class="o">.</span><span class="n">createRectangle</span><span class="p">([</span><span class="mi">3018</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">4103</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">200</span><span class="p">],[</span><span class="mi">3018</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">4103</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">200</span><span class="p">],</span><span class="s1">&#39;rectangle_test&#39;</span><span class="p">)</span> 
    <span class="n">lmkX</span><span class="o">.</span><span class="n">selectRegionByName</span><span class="p">(</span><span class="s1">&#39;rectangle_test&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--5-- Test get_color_autoscan_times&#39;</span><span class="p">)</span>
    <span class="c1"># Get color_autoscan_exposuretimes:</span>
    <span class="n">color_autoscan_times</span> <span class="o">=</span> <span class="n">lmkX</span><span class="o">.</span><span class="n">get_color_autoscan_times</span><span class="p">()</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">color_autoscan_times</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--6a-- Test measurement times for autoscan off&#39;</span><span class="p">)</span>
    <span class="n">tb</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">lmkX</span><span class="o">.</span><span class="n">captureXYZmap</span><span class="p">(</span><span class="n">folder_name</span><span class="p">,</span> <span class="s1">&#39;testXYZ2_</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">te</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time autoscan == False&#39;</span><span class="p">,</span> <span class="n">te</span> <span class="o">-</span> <span class="n">tb</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--6b-- Test measurement times for autoscan off&#39;</span><span class="p">)</span>
    <span class="n">tb</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">lmkX</span><span class="o">.</span><span class="n">captureXYZmap</span><span class="p">(</span><span class="n">folder_name</span><span class="p">,</span> <span class="s1">&#39;testXYZ2_</span><span class="si">{:1.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">autoscan</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">te</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time autoscan == True&#39;</span><span class="p">,</span> <span class="n">te</span> <span class="o">-</span> <span class="n">tb</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">--7-- TESTS END&#39;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">lmkX</span> 
    
    <span class="c1"># if False: </span>
    <span class="c1">#     kill_lmk4_process(1) </span>
    

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kevin A.G. Smet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>